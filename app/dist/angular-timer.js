var timerModule=angular.module("timer",[]).directive("timer",["$compile",function($compile){return{restrict:"EA",replace:!1,scope:{interval:"=interval",startTimeAttr:"=startTime",endTimeAttr:"=endTime",countdownattr:"=countdown",finishCallback:"&finishCallback",autoStart:"&autoStart",language:"@?",fallback:"@?",maxTimeUnit:"=",seconds:"=?",minutes:"=?",hours:"=?",days:"=?",months:"=?",years:"=?",secondsS:"=?",minutesS:"=?",hoursS:"=?",daysS:"=?",monthsS:"=?",yearsS:"=?"},controller:["$scope","$element","$attrs","$timeout","I18nService","$interpolate","progressBarService",function($scope,$element,$attrs,$timeout,I18nService,$interpolate,progressBarService){function resetTimeout(){$scope.timeoutId&&clearTimeout($scope.timeoutId)}function calculateTimeUnits(){var timeUnits={};void 0!==$attrs.startTime&&($scope.millis=moment().diff(moment($scope.startTimeAttr))),timeUnits=i18nService.getTimeUnits($scope.millis),$scope.maxTimeUnit&&"day"!==$scope.maxTimeUnit?"second"===$scope.maxTimeUnit?($scope.seconds=Math.floor($scope.millis/1e3),$scope.minutes=0,$scope.hours=0,$scope.days=0,$scope.months=0,$scope.years=0):"minute"===$scope.maxTimeUnit?($scope.seconds=Math.floor($scope.millis/1e3%60),$scope.minutes=Math.floor($scope.millis/6e4),$scope.hours=0,$scope.days=0,$scope.months=0,$scope.years=0):"hour"===$scope.maxTimeUnit?($scope.seconds=Math.floor($scope.millis/1e3%60),$scope.minutes=Math.floor($scope.millis/6e4%60),$scope.hours=Math.floor($scope.millis/36e5),$scope.days=0,$scope.months=0,$scope.years=0):"month"===$scope.maxTimeUnit?($scope.seconds=Math.floor($scope.millis/1e3%60),$scope.minutes=Math.floor($scope.millis/6e4%60),$scope.hours=Math.floor($scope.millis/36e5%24),$scope.days=Math.floor($scope.millis/36e5/24%30),$scope.months=Math.floor($scope.millis/36e5/24/30),$scope.years=0):"year"===$scope.maxTimeUnit&&($scope.seconds=Math.floor($scope.millis/1e3%60),$scope.minutes=Math.floor($scope.millis/6e4%60),$scope.hours=Math.floor($scope.millis/36e5%24),$scope.days=Math.floor($scope.millis/36e5/24%30),$scope.months=Math.floor($scope.millis/36e5/24/30%12),$scope.years=Math.floor($scope.millis/36e5/24/365)):($scope.seconds=Math.floor($scope.millis/1e3%60),$scope.minutes=Math.floor($scope.millis/6e4%60),$scope.hours=Math.floor($scope.millis/36e5%24),$scope.days=Math.floor($scope.millis/36e5/24),$scope.months=0,$scope.years=0),$scope.secondsS=1===$scope.seconds?"":"s",$scope.minutesS=1===$scope.minutes?"":"s",$scope.hoursS=1===$scope.hours?"":"s",$scope.daysS=1===$scope.days?"":"s",$scope.monthsS=1===$scope.months?"":"s",$scope.yearsS=1===$scope.years?"":"s",$scope.secondUnit=timeUnits.seconds,$scope.minuteUnit=timeUnits.minutes,$scope.hourUnit=timeUnits.hours,$scope.dayUnit=timeUnits.days,$scope.monthUnit=timeUnits.months,$scope.yearUnit=timeUnits.years,$scope.sseconds=$scope.seconds<10?"0"+$scope.seconds:$scope.seconds,$scope.mminutes=$scope.minutes<10?"0"+$scope.minutes:$scope.minutes,$scope.hhours=$scope.hours<10?"0"+$scope.hours:$scope.hours,$scope.ddays=$scope.days<10?"0"+$scope.days:$scope.days,$scope.mmonths=$scope.months<10?"0"+$scope.months:$scope.months,$scope.yyears=$scope.years<10?"0"+$scope.years:$scope.years}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),$scope.autoStart=$attrs.autoStart||$attrs.autostart,$scope.language=$scope.language||"en",$scope.fallback=$scope.fallback||"en",$scope.$watch("language",function(newVal,oldVal){void 0!==newVal&&i18nService.init(newVal,$scope.fallback)});var i18nService=new I18nService;i18nService.init($scope.language,$scope.fallback),$scope.displayProgressBar=0,$scope.displayProgressActive="active",0===$element.html().trim().length?$element.append($compile("<span>"+$interpolate.startSymbol()+"millis"+$interpolate.endSymbol()+"</span>")($scope)):$element.append($compile($element.contents())($scope)),$scope.startTime=null,$scope.endTime=null,$scope.timeoutId=null,$scope.countdown=angular.isNumber($scope.countdownattr)&&parseInt($scope.countdownattr,10)>=0?parseInt($scope.countdownattr,10):void 0,$scope.isRunning=!1,$scope.$on("timer-start",function(){$scope.start()}),$scope.$on("timer-resume",function(){$scope.resume()}),$scope.$on("timer-stop",function(){$scope.stop()}),$scope.$on("timer-clear",function(){$scope.clear()}),$scope.$on("timer-reset",function(){$scope.reset()}),$scope.$on("timer-set-countdown",function(e,countdown){$scope.countdown=countdown}),$scope.$watch("startTimeAttr",function(newValue,oldValue){newValue!==oldValue&&$scope.isRunning&&$scope.start()}),$scope.$watch("endTimeAttr",function(newValue,oldValue){newValue!==oldValue&&$scope.isRunning&&$scope.start()}),$scope.start=function(){$scope.startTime=$scope.startTimeAttr?moment($scope.startTimeAttr):moment(),$scope.endTime=$scope.endTimeAttr?moment($scope.endTimeAttr):null,angular.isNumber($scope.countdown)||($scope.countdown=angular.isNumber($scope.countdownattr)&&parseInt($scope.countdownattr,10)>0?parseInt($scope.countdownattr,10):void 0),resetTimeout(),tick(),$scope.isRunning=!0,$scope.$emit("timer-started",{timeoutId:$scope.timeoutId,millis:$scope.millis,seconds:$scope.seconds,minutes:$scope.minutes,hours:$scope.hours,days:$scope.days})},$scope.resume=function(){resetTimeout(),$scope.countdownattr&&($scope.countdown+=1),$scope.startTime=moment().diff(moment($scope.stoppedTime).diff(moment($scope.startTime))),tick(),$scope.isRunning=!0,$scope.$emit("timer-started",{timeoutId:$scope.timeoutId,millis:$scope.millis,seconds:$scope.seconds,minutes:$scope.minutes,hours:$scope.hours,days:$scope.days})},$scope.stop=$scope.pause=function(){var timeoutId=$scope.timeoutId;$scope.clear(),$scope.$emit("timer-stopped",{timeoutId:timeoutId,millis:$scope.millis,seconds:$scope.seconds,minutes:$scope.minutes,hours:$scope.hours,days:$scope.days})},$scope.clear=function(){$scope.stoppedTime=moment(),resetTimeout(),$scope.timeoutId=null,$scope.isRunning=!1},$scope.reset=function(){$scope.startTime=$scope.startTimeAttr?moment($scope.startTimeAttr):moment(),$scope.endTime=$scope.endTimeAttr?moment($scope.endTimeAttr):null,$scope.countdown=angular.isNumber($scope.countdownattr)&&parseInt($scope.countdownattr,10)>0?parseInt($scope.countdownattr,10):void 0,resetTimeout(),tick(),$scope.isRunning=!1,$scope.clear(),$scope.$emit("timer-reset",{timeoutId:timeoutId,millis:$scope.millis,seconds:$scope.seconds,minutes:$scope.minutes,hours:$scope.hours,days:$scope.days})},$element.bind("$destroy",function(){resetTimeout(),$scope.isRunning=!1}),$scope.countdownattr?($scope.millis=1e3*$scope.countdownattr,$scope.addCDSeconds=function(extraSeconds){$scope.countdown+=extraSeconds,$scope.isRunning||$scope.start()},$scope.$on("timer-add-cd-seconds",function(e,extraSeconds){$scope.addCDSeconds(extraSeconds)}),$scope.$on("timer-set-countdown-seconds",function(e,countdownSeconds){$scope.isRunning||$scope.clear(),$scope.countdown=countdownSeconds,$scope.millis=1e3*countdownSeconds,calculateTimeUnits()})):$scope.millis=0,calculateTimeUnits();var tick=function tick(){var typeTimer=null;$scope.millis=moment().diff($scope.startTime);var adjustment=$scope.millis%1e3;if($scope.endTimeAttr&&(typeTimer=$scope.endTimeAttr,$scope.millis=moment($scope.endTime).diff(moment()),adjustment=$scope.interval-$scope.millis%1e3),$scope.countdownattr&&(typeTimer=$scope.countdownattr,$scope.millis=1e3*$scope.countdown),$scope.millis<0)return $scope.stop(),$scope.millis=0,calculateTimeUnits(),void($scope.finishCallback&&$scope.$eval($scope.finishCallback));calculateTimeUnits(),$scope.timeoutId=setTimeout(function(){tick(),$scope.$apply()},$scope.interval-adjustment),$scope.$emit("timer-tick",{timeoutId:$scope.timeoutId,millis:$scope.millis,seconds:$scope.seconds,minutes:$scope.minutes,hours:$scope.hours,days:$scope.days}),$scope.countdown>0?$scope.countdown--:$scope.countdown<=0&&($scope.stop(),$scope.finishCallback&&$scope.$eval($scope.finishCallback)),null!==typeTimer&&($scope.progressBar=progressBarService.calculateProgressBar($scope.startTime,$scope.millis,$scope.endTime,$scope.countdownattr),100===$scope.progressBar&&($scope.displayProgressActive=""))};void 0!==$scope.autoStart&&!0!==$scope.autoStart||$scope.start()}]}}]).directive("timerControls",function(){return{restrict:"EA",scope:!0,controller:["$scope",function($scope){$scope.timerStatus="reset",$scope.$on("timer-started",function(){$scope.timerStatus="started"}),$scope.$on("timer-stopped",function(){$scope.timerStatus="stopped"}),$scope.$on("timer-reset",function(){$scope.timerStatus="reset"}),$scope.timerStart=function(){$scope.$broadcast("timer-start")},$scope.timerStop=function(){$scope.$broadcast("timer-stop")},$scope.timerResume=function(){$scope.$broadcast("timer-resume")},$scope.timerToggle=function(){switch($scope.timerStatus){case"started":$scope.timerStop();break;case"stopped":$scope.timerResume();break;case"reset":$scope.timerStart()}},$scope.timerAddCDSeconds=function(extraSeconds){$scope.$broadcast("timer-add-cd-seconds",extraSeconds)}}]}});"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports=timerModule);var app=angular.module("timer");app.factory("I18nService",function(){var I18nService=function(){};return I18nService.prototype.language="en",I18nService.prototype.fallback="en",I18nService.prototype.timeHumanizer={},I18nService.prototype.init=function(lang,fallback){var supported_languages=humanizeDuration.getSupportedLanguages();this.fallback=void 0!==fallback?fallback:"en",-1===supported_languages.indexOf(fallback)&&(this.fallback="en"),this.language=lang,-1===supported_languages.indexOf(lang)&&(this.language=this.fallback),this.timeHumanizer=humanizeDuration.humanizer({language:this.language,halfUnit:!1})},I18nService.prototype.getTimeUnits=function(millis){var diffFromAlarm=1e3*Math.round(millis/1e3),time={};return void 0!==this.timeHumanizer?time={millis:this.timeHumanizer(diffFromAlarm,{units:["ms"]}),seconds:this.timeHumanizer(diffFromAlarm,{units:["s"]}),minutes:this.timeHumanizer(diffFromAlarm,{units:["m","s"]}),hours:this.timeHumanizer(diffFromAlarm,{units:["h","m","s"]}),days:this.timeHumanizer(diffFromAlarm,{units:["d","h","m","s"]}),months:this.timeHumanizer(diffFromAlarm,{units:["mo","d","h","m","s"]}),years:this.timeHumanizer(diffFromAlarm,{units:["y","mo","d","h","m","s"]})}:console.error('i18nService has not been initialized. You must call i18nService.init("en") for example'),time},I18nService});var app=angular.module("timer");app.factory("progressBarService",function(){var ProgressBarService=function(){};return ProgressBarService.prototype.calculateProgressBar=function(startValue,remainingTime,endTimeAttr,coutdown){var endTimeValue,initialCountdown,displayProgressBar=0;return remainingTime/=1e3,null!==endTimeAttr?(endTimeValue=moment(endTimeAttr),initialCountdown=endTimeValue.diff(startValue,"seconds"),displayProgressBar=100*remainingTime/initialCountdown):displayProgressBar=100*remainingTime/coutdown,displayProgressBar=100-displayProgressBar,displayProgressBar=Math.round(10*displayProgressBar)/10,displayProgressBar>100&&(displayProgressBar=100),displayProgressBar},new ProgressBarService});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuZ3VsYXItdGltZXIuanMiXSwibmFtZXMiOlsidGltZXJNb2R1bGUiLCJhbmd1bGFyIiwibW9kdWxlIiwiZGlyZWN0aXZlIiwiJGNvbXBpbGUiLCJyZXN0cmljdCIsInJlcGxhY2UiLCJzY29wZSIsImludGVydmFsIiwic3RhcnRUaW1lQXR0ciIsImVuZFRpbWVBdHRyIiwiY291bnRkb3duYXR0ciIsImZpbmlzaENhbGxiYWNrIiwiYXV0b1N0YXJ0IiwibGFuZ3VhZ2UiLCJmYWxsYmFjayIsIm1heFRpbWVVbml0Iiwic2Vjb25kcyIsIm1pbnV0ZXMiLCJob3VycyIsImRheXMiLCJtb250aHMiLCJ5ZWFycyIsInNlY29uZHNTIiwibWludXRlc1MiLCJob3Vyc1MiLCJkYXlzUyIsIm1vbnRoc1MiLCJ5ZWFyc1MiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiJGVsZW1lbnQiLCIkYXR0cnMiLCIkdGltZW91dCIsIkkxOG5TZXJ2aWNlIiwiJGludGVycG9sYXRlIiwicHJvZ3Jlc3NCYXJTZXJ2aWNlIiwicmVzZXRUaW1lb3V0IiwidGltZW91dElkIiwiY2xlYXJUaW1lb3V0IiwiY2FsY3VsYXRlVGltZVVuaXRzIiwidGltZVVuaXRzIiwidW5kZWZpbmVkIiwic3RhcnRUaW1lIiwibWlsbGlzIiwibW9tZW50IiwiZGlmZiIsImkxOG5TZXJ2aWNlIiwiZ2V0VGltZVVuaXRzIiwiTWF0aCIsImZsb29yIiwic2Vjb25kVW5pdCIsIm1pbnV0ZVVuaXQiLCJob3VyVW5pdCIsImRheVVuaXQiLCJtb250aFVuaXQiLCJ5ZWFyVW5pdCIsInNzZWNvbmRzIiwibW1pbnV0ZXMiLCJoaG91cnMiLCJkZGF5cyIsIm1tb250aHMiLCJ5eWVhcnMiLCJTdHJpbmciLCJwcm90b3R5cGUiLCJ0cmltIiwidGhpcyIsImF1dG9zdGFydCIsIiR3YXRjaCIsIm5ld1ZhbCIsIm9sZFZhbCIsImluaXQiLCJkaXNwbGF5UHJvZ3Jlc3NCYXIiLCJkaXNwbGF5UHJvZ3Jlc3NBY3RpdmUiLCJodG1sIiwibGVuZ3RoIiwiYXBwZW5kIiwic3RhcnRTeW1ib2wiLCJlbmRTeW1ib2wiLCJjb250ZW50cyIsImVuZFRpbWUiLCJjb3VudGRvd24iLCJpc051bWJlciIsInBhcnNlSW50IiwiaXNSdW5uaW5nIiwiJG9uIiwic3RhcnQiLCJyZXN1bWUiLCJzdG9wIiwiY2xlYXIiLCJyZXNldCIsImUiLCJuZXdWYWx1ZSIsIm9sZFZhbHVlIiwidGljayIsIiRlbWl0Iiwic3RvcHBlZFRpbWUiLCJwYXVzZSIsImJpbmQiLCJhZGRDRFNlY29uZHMiLCJleHRyYVNlY29uZHMiLCJjb3VudGRvd25TZWNvbmRzIiwidHlwZVRpbWVyIiwiYWRqdXN0bWVudCIsIiRldmFsIiwic2V0VGltZW91dCIsIiRhcHBseSIsInByb2dyZXNzQmFyIiwiY2FsY3VsYXRlUHJvZ3Jlc3NCYXIiLCJ0aW1lclN0YXR1cyIsInRpbWVyU3RhcnQiLCIkYnJvYWRjYXN0IiwidGltZXJTdG9wIiwidGltZXJSZXN1bWUiLCJ0aW1lclRvZ2dsZSIsInRpbWVyQWRkQ0RTZWNvbmRzIiwiZXhwb3J0cyIsImFwcCIsImZhY3RvcnkiLCJ0aW1lSHVtYW5pemVyIiwibGFuZyIsInN1cHBvcnRlZF9sYW5ndWFnZXMiLCJodW1hbml6ZUR1cmF0aW9uIiwiZ2V0U3VwcG9ydGVkTGFuZ3VhZ2VzIiwiaW5kZXhPZiIsImh1bWFuaXplciIsImhhbGZVbml0IiwiZGlmZkZyb21BbGFybSIsInJvdW5kIiwidGltZSIsInVuaXRzIiwiY29uc29sZSIsImVycm9yIiwiUHJvZ3Jlc3NCYXJTZXJ2aWNlIiwic3RhcnRWYWx1ZSIsInJlbWFpbmluZ1RpbWUiLCJjb3V0ZG93biIsImVuZFRpbWVWYWx1ZSIsImluaXRpYWxDb3VudGRvd24iXSwibWFwcGluZ3MiOiJBQU9BLEdBQUlBLGFBQWNDLFFBQVFDLE9BQU8sWUFDOUJDLFVBQVUsU0FBVSxXQUFZLFNBQVVDLFVBQ3pDLE9BQ0VDLFNBQVUsS0FDVkMsU0FBUyxFQUNUQyxPQUNFQyxTQUFVLFlBQ1ZDLGNBQWUsYUFDZkMs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QU0sMEZBR1hILE1BR0ovRixhQUdYLElBQUltRixLQUFNcEgsUUFBUUMsT0FBTyxRQUV6Qm1ILEtBQUlDLFFBQVEscUJBQXNCLFdBRWhDLEdBQUllLG9CQUFxQixZQXdDekIsT0EzQkFBLG9CQUFtQnJFLFVBQVU0QyxxQkFBdUIsU0FBOEIwQixXQUFZQyxjQUFlN0gsWUFBYThILFVBQ3hILEdBQ0VDLGNBQ0FDLGlCQUZFbEUsbUJBQXFCLENBdUJ6QixPQW5CQStELGdCQUFnQyxJQUdiLE9BQWhCN0gsYUFDRCtILGFBQWU1RixPQUFPbkMsYUFDdEJnSSxpQkFBbUJELGFBQWEzRixLQUFLd0YsV0FBWSxXQUNqRDlELG1CQUFxQyxJQUFoQitELGNBQXNCRyxrQkFHM0NsRSxtQkFBcUMsSUFBaEIrRCxjQUFzQkMsU0FHN0NoRSxtQkFBcUIsSUFBTUEsbUJBQzNCQSxtQkFBcUJ2QixLQUFLK0UsTUFBMkIsR0FBckJ4RCxvQkFBMkIsR0FFeERBLG1CQUFxQixNQUN0QkEsbUJBQXFCLEtBR2hCQSxvQkFHRixHQUFJNkQiLCJmaWxlIjoiYW5ndWxhci10aW1lci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogYW5ndWxhci10aW1lciAtIHYxLjMuNSAtIDIwMTctMDMtMDkgMjoxOCBQTVxuICogaHR0cHM6Ly9naXRodWIuY29tL3NpZGRpaS9hbmd1bGFyLXRpbWVyXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE3IEFkcmlhbiBXYXJkZWxsXG4gKiBMaWNlbnNlZCBNSVQgPGh0dHBzOi8vZ2l0aHViLmNvbS9zaWRkaWkvYW5ndWxhci10aW1lci9ibG9iL21hc3Rlci9MSUNFTlNFLnR4dD5cbiAqL1xudmFyIHRpbWVyTW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ3RpbWVyJywgW10pXG4gIC5kaXJlY3RpdmUoJ3RpbWVyJywgWyckY29tcGlsZScsIGZ1bmN0aW9uICgkY29tcGlsZSkge1xuICAgIHJldHVybiAge1xuICAgICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgICByZXBsYWNlOiBmYWxzZSxcbiAgICAgIHNjb3BlOiB7XG4gICAgICAgIGludGVydmFsOiAnPWludGVydmFsJyxcbiAgICAgICAgc3RhcnRUaW1lQXR0cjogJz1zdGFydFRpbWUnLFxuICAgICAgICBlbmRUaW1lQXR0cjogJz1lbmRUaW1lJyxcbiAgICAgICAgY291bnRkb3duYXR0cjogJz1jb3VudGRvd24nLFxuICAgICAgICBmaW5pc2hDYWxsYmFjazogJyZmaW5pc2hDYWxsYmFjaycsXG4gICAgICAgIGF1dG9TdGFydDogJyZhdXRvU3RhcnQnLFxuICAgICAgICBsYW5ndWFnZTogJ0A/JyxcbiAgICAgICAgZmFsbGJhY2s6ICdAPycsXG4gICAgICAgIG1heFRpbWVVbml0OiAnPScsXG4gICAgICAgIHNlY29uZHM6ICc9PycsXG4gICAgICAgIG1pbnV0ZXM6ICc9PycsXG4gICAgICAgIGhvdXJzOiAnPT8nLFxuICAgICAgICBkYXlzOiAnPT8nLFxuICAgICAgICBtb250aHM6ICc9PycsXG4gICAgICAgIHllYXJzOiAnPT8nLFxuICAgICAgICBzZWNvbmRzUzogJz0/JyxcbiAgICAgICAgbWludXRlc1M6ICc9PycsXG4gICAgICAgIGhvdXJzUzogJz0/JyxcbiAgICAgICAgZGF5c1M6ICc9PycsXG4gICAgICAgIG1vbnRoc1M6ICc9PycsXG4gICAgICAgIHllYXJzUzogJz0/J1xuICAgICAgfSxcbiAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRlbGVtZW50JywgJyRhdHRycycsICckdGltZW91dCcsICdJMThuU2VydmljZScsICckaW50ZXJwb2xhdGUnLCAncHJvZ3Jlc3NCYXJTZXJ2aWNlJywgZnVuY3Rpb24gKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJHRpbWVvdXQsIEkxOG5TZXJ2aWNlLCAkaW50ZXJwb2xhdGUsIHByb2dyZXNzQmFyU2VydmljZSkge1xuXG4gICAgICAgIC8vIENoZWNraW5nIGZvciB0cmltIGZ1bmN0aW9uIHNpbmNlIElFOCBkb2Vzbid0IGhhdmUgaXRcbiAgICAgICAgLy8gSWYgbm90IGEgZnVuY3Rpb24sIGNyZWF0ZSB0aXJtIHdpdGggUmVnRXggdG8gbWltaWMgbmF0aXZlIHRyaW1cbiAgICAgICAgaWYgKHR5cGVvZiBTdHJpbmcucHJvdG90eXBlLnRyaW0gIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBTdHJpbmcucHJvdG90eXBlLnRyaW0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJyk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vYW5ndWxhciAxLjIgZG9lc24ndCBzdXBwb3J0IGF0dHJpYnV0ZXMgZW5kaW5nIGluIFwiLXN0YXJ0XCIsIHNvIHdlJ3JlXG4gICAgICAgIC8vc3VwcG9ydGluZyBib3RoIFwiYXV0b3N0YXJ0XCIgYW5kIFwiYXV0by1zdGFydFwiIGFzIGEgc29sdXRpb24gZm9yXG4gICAgICAgIC8vYmFja3dhcmQgYW5kIGZvcndhcmQgY29tcGF0aWJpbGl0eS5cbiAgICAgICAgJHNjb3BlLmF1dG9TdGFydCA9ICRhdHRycy5hdXRvU3RhcnQgfHwgJGF0dHJzLmF1dG9zdGFydDtcblxuXG4gICAgICAgICRzY29wZS5sYW5ndWFnZSA9ICRzY29wZS5sYW5ndWFnZSB8fCAnZW4nO1xuICAgICAgICAkc2NvcGUuZmFsbGJhY2sgPSAkc2NvcGUuZmFsbGJhY2sgfHwgJ2VuJztcblxuICAgICAgICAvL2FsbG93IHRvIGNoYW5nZSB0aGUgbGFuZ3VhZ2Ugb2YgdGhlIGRpcmVjdGl2ZSB3aGlsZSBhbHJlYWR5IGxhdW5jaGVkXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ2xhbmd1YWdlJywgZnVuY3Rpb24obmV3VmFsLCBvbGRWYWwpIHtcbiAgICAgICAgICBpZihuZXdWYWwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaTE4blNlcnZpY2UuaW5pdChuZXdWYWwsICRzY29wZS5mYWxsYmFjayk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvL2luaXQgbW9tZW50SlMgaTE4biwgZGVmYXVsdCBlbmdsaXNoXG4gICAgICAgIHZhciBpMThuU2VydmljZSA9IG5ldyBJMThuU2VydmljZSgpO1xuICAgICAgICBpMThuU2VydmljZS5pbml0KCRzY29wZS5sYW5ndWFnZSwgJHNjb3BlLmZhbGxiYWNrKTtcblxuICAgICAgICAvL3Byb2dyZXNzIGJhclxuICAgICAgICAkc2NvcGUuZGlzcGxheVByb2dyZXNzQmFyID0gMDtcbiAgICAgICAgJHNjb3BlLmRpc3BsYXlQcm9ncmVzc0FjdGl2ZSA9ICdhY3RpdmUnOyAvL0Jvb3RzdHJhcCBhY3RpdmUgZWZmZWN0IGZvciBwcm9ncmVzcyBiYXJcblxuICAgICAgICBpZiAoJGVsZW1lbnQuaHRtbCgpLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAkZWxlbWVudC5hcHBlbmQoJGNvbXBpbGUoJzxzcGFuPicgKyAkaW50ZXJwb2xhdGUuc3RhcnRTeW1ib2woKSArICdtaWxsaXMnICsgJGludGVycG9sYXRlLmVuZFN5bWJvbCgpICsgJzwvc3Bhbj4nKSgkc2NvcGUpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkZWxlbWVudC5hcHBlbmQoJGNvbXBpbGUoJGVsZW1lbnQuY29udGVudHMoKSkoJHNjb3BlKSk7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuc3RhcnRUaW1lID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLmVuZFRpbWUgPSBudWxsO1xuICAgICAgICAkc2NvcGUudGltZW91dElkID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLmNvdW50ZG93biA9IGFuZ3VsYXIuaXNOdW1iZXIoJHNjb3BlLmNvdW50ZG93bmF0dHIpICYmIHBhcnNlSW50KCRzY29wZS5jb3VudGRvd25hdHRyLCAxMCkgPj0gMCA/IHBhcnNlSW50KCRzY29wZS5jb3VudGRvd25hdHRyLCAxMCkgOiB1bmRlZmluZWQ7XG4gICAgICAgICRzY29wZS5pc1J1bm5pbmcgPSBmYWxzZTtcblxuICAgICAgICAkc2NvcGUuJG9uKCd0aW1lci1zdGFydCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAkc2NvcGUuc3RhcnQoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiRvbigndGltZXItcmVzdW1lJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICRzY29wZS5yZXN1bWUoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiRvbigndGltZXItc3RvcCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAkc2NvcGUuc3RvcCgpO1xuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuJG9uKCd0aW1lci1jbGVhcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAkc2NvcGUuY2xlYXIoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiRvbigndGltZXItcmVzZXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJHNjb3BlLnJlc2V0KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS4kb24oJ3RpbWVyLXNldC1jb3VudGRvd24nLCBmdW5jdGlvbiAoZSwgY291bnRkb3duKSB7XG4gICAgICAgICAgJHNjb3BlLmNvdW50ZG93biA9IGNvdW50ZG93bjtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZnVuY3Rpb24gcmVzZXRUaW1lb3V0KCkge1xuICAgICAgICAgIGlmICgkc2NvcGUudGltZW91dElkKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQoJHNjb3BlLnRpbWVvdXRJZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCgnc3RhcnRUaW1lQXR0cicsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gb2xkVmFsdWUgJiYgJHNjb3BlLmlzUnVubmluZykge1xuICAgICAgICAgICAgJHNjb3BlLnN0YXJ0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuJHdhdGNoKCdlbmRUaW1lQXR0cicsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gb2xkVmFsdWUgJiYgJHNjb3BlLmlzUnVubmluZykge1xuICAgICAgICAgICAgJHNjb3BlLnN0YXJ0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJHNjb3BlLnN0YXJ0VGltZSA9ICRzY29wZS5zdGFydFRpbWVBdHRyID8gbW9tZW50KCRzY29wZS5zdGFydFRpbWVBdHRyKSA6IG1vbWVudCgpO1xuICAgICAgICAgICRzY29wZS5lbmRUaW1lID0gJHNjb3BlLmVuZFRpbWVBdHRyID8gbW9tZW50KCRzY29wZS5lbmRUaW1lQXR0cikgOiBudWxsO1xuICAgICAgICAgIGlmICghYW5ndWxhci5pc051bWJlcigkc2NvcGUuY291bnRkb3duKSkge1xuICAgICAgICAgICAgJHNjb3BlLmNvdW50ZG93biA9IGFuZ3VsYXIuaXNOdW1iZXIoJHNjb3BlLmNvdW50ZG93bmF0dHIpICYmIHBhcnNlSW50KCRzY29wZS5jb3VudGRvd25hdHRyLCAxMCkgPiAwID8gcGFyc2VJbnQoJHNjb3BlLmNvdW50ZG93bmF0dHIsIDEwKSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVzZXRUaW1lb3V0KCk7XG4gICAgICAgICAgdGljaygpO1xuICAgICAgICAgICRzY29wZS5pc1J1bm5pbmcgPSB0cnVlO1xuICAgICAgICAgICRzY29wZS4kZW1pdCgndGltZXItc3RhcnRlZCcsIHtcbiAgICAgICAgICAgIHRpbWVvdXRJZDogJHNjb3BlLnRpbWVvdXRJZCxcbiAgICAgICAgICAgIG1pbGxpczogJHNjb3BlLm1pbGxpcyxcbiAgICAgICAgICAgIHNlY29uZHM6ICRzY29wZS5zZWNvbmRzLFxuICAgICAgICAgICAgbWludXRlczogJHNjb3BlLm1pbnV0ZXMsXG4gICAgICAgICAgICBob3VyczogJHNjb3BlLmhvdXJzLFxuICAgICAgICAgICAgZGF5czogJHNjb3BlLmRheXNcbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUucmVzdW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJlc2V0VGltZW91dCgpO1xuICAgICAgICAgIGlmICgkc2NvcGUuY291bnRkb3duYXR0cikge1xuICAgICAgICAgICAgJHNjb3BlLmNvdW50ZG93biArPSAxO1xuICAgICAgICAgIH1cbiAgICAgICAgICAkc2NvcGUuc3RhcnRUaW1lID0gbW9tZW50KCkuZGlmZigobW9tZW50KCRzY29wZS5zdG9wcGVkVGltZSkuZGlmZihtb21lbnQoJHNjb3BlLnN0YXJ0VGltZSkpKSk7XG4gICAgICAgICAgdGljaygpO1xuICAgICAgICAgICRzY29wZS5pc1J1bm5pbmcgPSB0cnVlO1xuICAgICAgICAgICRzY29wZS4kZW1pdCgndGltZXItc3RhcnRlZCcsIHtcbiAgICAgICAgICAgIHRpbWVvdXRJZDogJHNjb3BlLnRpbWVvdXRJZCxcbiAgICAgICAgICAgIG1pbGxpczogJHNjb3BlLm1pbGxpcyxcbiAgICAgICAgICAgIHNlY29uZHM6ICRzY29wZS5zZWNvbmRzLFxuICAgICAgICAgICAgbWludXRlczogJHNjb3BlLm1pbnV0ZXMsXG4gICAgICAgICAgICBob3VyczogJHNjb3BlLmhvdXJzLFxuICAgICAgICAgICAgZGF5czogJHNjb3BlLmRheXNcbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuc3RvcCA9ICRzY29wZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgdGltZW91dElkID0gJHNjb3BlLnRpbWVvdXRJZDtcbiAgICAgICAgICAkc2NvcGUuY2xlYXIoKTtcbiAgICAgICAgICAkc2NvcGUuJGVtaXQoJ3RpbWVyLXN0b3BwZWQnLCB7XG4gICAgICAgICAgICB0aW1lb3V0SWQ6IHRpbWVvdXRJZCxcbiAgICAgICAgICAgIG1pbGxpczogJHNjb3BlLm1pbGxpcyxcbiAgICAgICAgICAgIHNlY29uZHM6ICRzY29wZS5zZWNvbmRzLFxuICAgICAgICAgICAgbWludXRlczogJHNjb3BlLm1pbnV0ZXMsXG4gICAgICAgICAgICBob3VyczogJHNjb3BlLmhvdXJzLFxuICAgICAgICAgICAgZGF5czogJHNjb3BlLmRheXNcbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgLy8gc2FtZSBhcyBzdG9wIGJ1dCB3aXRob3V0IHRoZSBldmVudCBiZWluZyB0cmlnZ2VyZWRcbiAgICAgICAgICAkc2NvcGUuc3RvcHBlZFRpbWUgPSBtb21lbnQoKTtcbiAgICAgICAgICByZXNldFRpbWVvdXQoKTtcbiAgICAgICAgICAkc2NvcGUudGltZW91dElkID0gbnVsbDtcbiAgICAgICAgICAkc2NvcGUuaXNSdW5uaW5nID0gZmFsc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICRzY29wZS5zdGFydFRpbWUgPSAkc2NvcGUuc3RhcnRUaW1lQXR0ciA/IG1vbWVudCgkc2NvcGUuc3RhcnRUaW1lQXR0cikgOiBtb21lbnQoKTtcbiAgICAgICAgICAkc2NvcGUuZW5kVGltZSA9ICRzY29wZS5lbmRUaW1lQXR0ciA/IG1vbWVudCgkc2NvcGUuZW5kVGltZUF0dHIpIDogbnVsbDtcbiAgICAgICAgICAkc2NvcGUuY291bnRkb3duID0gYW5ndWxhci5pc051bWJlcigkc2NvcGUuY291bnRkb3duYXR0cikgJiYgcGFyc2VJbnQoJHNjb3BlLmNvdW50ZG93bmF0dHIsIDEwKSA+IDAgPyBwYXJzZUludCgkc2NvcGUuY291bnRkb3duYXR0ciwgMTApIDogdW5kZWZpbmVkO1xuICAgICAgICAgIHJlc2V0VGltZW91dCgpO1xuICAgICAgICAgIHRpY2soKTtcbiAgICAgICAgICAkc2NvcGUuaXNSdW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgJHNjb3BlLmNsZWFyKCk7XG4gICAgICAgICAgJHNjb3BlLiRlbWl0KCd0aW1lci1yZXNldCcsIHtcbiAgICAgICAgICAgIHRpbWVvdXRJZDogdGltZW91dElkLFxuICAgICAgICAgICAgbWlsbGlzOiAkc2NvcGUubWlsbGlzLFxuICAgICAgICAgICAgc2Vjb25kczogJHNjb3BlLnNlY29uZHMsXG4gICAgICAgICAgICBtaW51dGVzOiAkc2NvcGUubWludXRlcyxcbiAgICAgICAgICAgIGhvdXJzOiAkc2NvcGUuaG91cnMsXG4gICAgICAgICAgICBkYXlzOiAkc2NvcGUuZGF5c1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgICRlbGVtZW50LmJpbmQoJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJlc2V0VGltZW91dCgpO1xuICAgICAgICAgICRzY29wZS5pc1J1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgfSk7XG5cblxuICAgICAgICBmdW5jdGlvbiBjYWxjdWxhdGVUaW1lVW5pdHMoKSB7XG4gICAgICAgICAgdmFyIHRpbWVVbml0cyA9IHt9OyAvL3dpbGwgY29udGFpbnMgdGltZSB3aXRoIHVuaXRzXG5cbiAgICAgICAgICBpZiAoJGF0dHJzLnN0YXJ0VGltZSAhPT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICRzY29wZS5taWxsaXMgPSBtb21lbnQoKS5kaWZmKG1vbWVudCgkc2NvcGUuc3RhcnRUaW1lQXR0cikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRpbWVVbml0cyA9IGkxOG5TZXJ2aWNlLmdldFRpbWVVbml0cygkc2NvcGUubWlsbGlzKTtcblxuICAgICAgICAgIC8vIGNvbXB1dGUgdGltZSB2YWx1ZXMgYmFzZWQgb24gbWF4VGltZVVuaXQgc3BlY2lmaWNhdGlvblxuICAgICAgICAgIGlmICghJHNjb3BlLm1heFRpbWVVbml0IHx8ICRzY29wZS5tYXhUaW1lVW5pdCA9PT0gJ2RheScpIHtcbiAgICAgICAgICAgICRzY29wZS5zZWNvbmRzID0gTWF0aC5mbG9vcigoJHNjb3BlLm1pbGxpcyAvIDEwMDApICUgNjApO1xuICAgICAgICAgICAgJHNjb3BlLm1pbnV0ZXMgPSBNYXRoLmZsb29yKCgoJHNjb3BlLm1pbGxpcyAvICg2MDAwMCkpICUgNjApKTtcbiAgICAgICAgICAgICRzY29wZS5ob3VycyA9IE1hdGguZmxvb3IoKCgkc2NvcGUubWlsbGlzIC8gKDM2MDAwMDApKSAlIDI0KSk7XG4gICAgICAgICAgICAkc2NvcGUuZGF5cyA9IE1hdGguZmxvb3IoKCgkc2NvcGUubWlsbGlzIC8gKDM2MDAwMDApKSAvIDI0KSk7XG4gICAgICAgICAgICAkc2NvcGUubW9udGhzID0gMDtcbiAgICAgICAgICAgICRzY29wZS55ZWFycyA9IDA7XG4gICAgICAgICAgfSBlbHNlIGlmICgkc2NvcGUubWF4VGltZVVuaXQgPT09ICdzZWNvbmQnKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2Vjb25kcyA9IE1hdGguZmxvb3IoJHNjb3BlLm1pbGxpcyAvIDEwMDApO1xuICAgICAgICAgICAgJHNjb3BlLm1pbnV0ZXMgPSAwO1xuICAgICAgICAgICAgJHNjb3BlLmhvdXJzID0gMDtcbiAgICAgICAgICAgICRzY29wZS5kYXlzID0gMDtcbiAgICAgICAgICAgICRzY29wZS5tb250aHMgPSAwO1xuICAgICAgICAgICAgJHNjb3BlLnllYXJzID0gMDtcbiAgICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5tYXhUaW1lVW5pdCA9PT0gJ21pbnV0ZScpIHtcbiAgICAgICAgICAgICRzY29wZS5zZWNvbmRzID0gTWF0aC5mbG9vcigoJHNjb3BlLm1pbGxpcyAvIDEwMDApICUgNjApO1xuICAgICAgICAgICAgJHNjb3BlLm1pbnV0ZXMgPSBNYXRoLmZsb29yKCRzY29wZS5taWxsaXMgLyA2MDAwMCk7XG4gICAgICAgICAgICAkc2NvcGUuaG91cnMgPSAwO1xuICAgICAgICAgICAgJHNjb3BlLmRheXMgPSAwO1xuICAgICAgICAgICAgJHNjb3BlLm1vbnRocyA9IDA7XG4gICAgICAgICAgICAkc2NvcGUueWVhcnMgPSAwO1xuICAgICAgICAgIH0gZWxzZSBpZiAoJHNjb3BlLm1heFRpbWVVbml0ID09PSAnaG91cicpIHtcbiAgICAgICAgICAgICRzY29wZS5zZWNvbmRzID0gTWF0aC5mbG9vcigoJHNjb3BlLm1pbGxpcyAvIDEwMDApICUgNjApO1xuICAgICAgICAgICAgJHNjb3BlLm1pbnV0ZXMgPSBNYXRoLmZsb29yKCgoJHNjb3BlLm1pbGxpcyAvICg2MDAwMCkpICUgNjApKTtcbiAgICAgICAgICAgICRzY29wZS5ob3VycyA9IE1hdGguZmxvb3IoJHNjb3BlLm1pbGxpcyAvIDM2MDAwMDApO1xuICAgICAgICAgICAgJHNjb3BlLmRheXMgPSAwO1xuICAgICAgICAgICAgJHNjb3BlLm1vbnRocyA9IDA7XG4gICAgICAgICAgICAkc2NvcGUueWVhcnMgPSAwO1xuICAgICAgICAgIH0gZWxzZSBpZiAoJHNjb3BlLm1heFRpbWVVbml0ID09PSAnbW9udGgnKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2Vjb25kcyA9IE1hdGguZmxvb3IoKCRzY29wZS5taWxsaXMgLyAxMDAwKSAlIDYwKTtcbiAgICAgICAgICAgICRzY29wZS5taW51dGVzID0gTWF0aC5mbG9vcigoKCRzY29wZS5taWxsaXMgLyAoNjAwMDApKSAlIDYwKSk7XG4gICAgICAgICAgICAkc2NvcGUuaG91cnMgPSBNYXRoLmZsb29yKCgoJHNjb3BlLm1pbGxpcyAvICgzNjAwMDAwKSkgJSAyNCkpO1xuICAgICAgICAgICAgJHNjb3BlLmRheXMgPSBNYXRoLmZsb29yKCgoJHNjb3BlLm1pbGxpcyAvICgzNjAwMDAwKSkgLyAyNCkgJSAzMCk7XG4gICAgICAgICAgICAkc2NvcGUubW9udGhzID0gTWF0aC5mbG9vcigoKCRzY29wZS5taWxsaXMgLyAoMzYwMDAwMCkpIC8gMjQpIC8gMzApO1xuICAgICAgICAgICAgJHNjb3BlLnllYXJzID0gMDtcbiAgICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5tYXhUaW1lVW5pdCA9PT0gJ3llYXInKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2Vjb25kcyA9IE1hdGguZmxvb3IoKCRzY29wZS5taWxsaXMgLyAxMDAwKSAlIDYwKTtcbiAgICAgICAgICAgICRzY29wZS5taW51dGVzID0gTWF0aC5mbG9vcigoKCRzY29wZS5taWxsaXMgLyAoNjAwMDApKSAlIDYwKSk7XG4gICAgICAgICAgICAkc2NvcGUuaG91cnMgPSBNYXRoLmZsb29yKCgoJHNjb3BlLm1pbGxpcyAvICgzNjAwMDAwKSkgJSAyNCkpO1xuICAgICAgICAgICAgJHNjb3BlLmRheXMgPSBNYXRoLmZsb29yKCgoJHNjb3BlLm1pbGxpcyAvICgzNjAwMDAwKSkgLyAyNCkgJSAzMCk7XG4gICAgICAgICAgICAkc2NvcGUubW9udGhzID0gTWF0aC5mbG9vcigoKCRzY29wZS5taWxsaXMgLyAoMzYwMDAwMCkpIC8gMjQgLyAzMCkgJSAxMik7XG4gICAgICAgICAgICAkc2NvcGUueWVhcnMgPSBNYXRoLmZsb29yKCgkc2NvcGUubWlsbGlzIC8gKDM2MDAwMDApKSAvIDI0IC8gMzY1KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gcGx1cmFsIC0gc2luZ3VsYXIgdW5pdCBkZWNpc2lvbiAob2xkIHN5bnRheCwgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IGFuZCBFbmdsaXNoIG9ubHksIGNvdWxkIGJlIGRlcHJlY2F0ZWQhKVxuICAgICAgICAgICRzY29wZS5zZWNvbmRzUyA9ICgkc2NvcGUuc2Vjb25kcyA9PT0gMSkgPyAnJyA6ICdzJztcbiAgICAgICAgICAkc2NvcGUubWludXRlc1MgPSAoJHNjb3BlLm1pbnV0ZXMgPT09IDEpID8gJycgOiAncyc7XG4gICAgICAgICAgJHNjb3BlLmhvdXJzUyA9ICgkc2NvcGUuaG91cnMgPT09IDEpID8gJycgOiAncyc7XG4gICAgICAgICAgJHNjb3BlLmRheXNTID0gKCRzY29wZS5kYXlzID09PSAxKT8gJycgOiAncyc7XG4gICAgICAgICAgJHNjb3BlLm1vbnRoc1MgPSAoJHNjb3BlLm1vbnRocyA9PT0gMSk/ICcnIDogJ3MnO1xuICAgICAgICAgICRzY29wZS55ZWFyc1MgPSAoJHNjb3BlLnllYXJzID09PSAxKT8gJycgOiAncyc7XG5cblxuICAgICAgICAgIC8vIG5ldyBwbHVyYWwtc2luZ3VsYXIgdW5pdCBkZWNpc2lvbiBmdW5jdGlvbnMgKGZvciBjdXN0b20gdW5pdHMgYW5kIG11bHRpbGluZ3VhbCBzdXBwb3J0KVxuICAgICAgICAgICRzY29wZS5zZWNvbmRVbml0ID0gdGltZVVuaXRzLnNlY29uZHM7XG4gICAgICAgICAgJHNjb3BlLm1pbnV0ZVVuaXQgPSB0aW1lVW5pdHMubWludXRlcztcbiAgICAgICAgICAkc2NvcGUuaG91clVuaXQgPSB0aW1lVW5pdHMuaG91cnM7XG4gICAgICAgICAgJHNjb3BlLmRheVVuaXQgPSB0aW1lVW5pdHMuZGF5cztcbiAgICAgICAgICAkc2NvcGUubW9udGhVbml0ID0gdGltZVVuaXRzLm1vbnRocztcbiAgICAgICAgICAkc2NvcGUueWVhclVuaXQgPSB0aW1lVW5pdHMueWVhcnM7XG5cbiAgICAgICAgICAvL2FkZCBsZWFkaW5nIHplcm8gaWYgbnVtYmVyIGlzIHNtYWxsZXIgdGhhbiAxMFxuICAgICAgICAgICRzY29wZS5zc2Vjb25kcyA9ICRzY29wZS5zZWNvbmRzIDwgMTAgPyAnMCcgKyAkc2NvcGUuc2Vjb25kcyA6ICRzY29wZS5zZWNvbmRzO1xuICAgICAgICAgICRzY29wZS5tbWludXRlcyA9ICRzY29wZS5taW51dGVzIDwgMTAgPyAnMCcgKyAkc2NvcGUubWludXRlcyA6ICRzY29wZS5taW51dGVzO1xuICAgICAgICAgICRzY29wZS5oaG91cnMgPSAkc2NvcGUuaG91cnMgPCAxMCA/ICcwJyArICRzY29wZS5ob3VycyA6ICRzY29wZS5ob3VycztcbiAgICAgICAgICAkc2NvcGUuZGRheXMgPSAkc2NvcGUuZGF5cyA8IDEwID8gJzAnICsgJHNjb3BlLmRheXMgOiAkc2NvcGUuZGF5cztcbiAgICAgICAgICAkc2NvcGUubW1vbnRocyA9ICRzY29wZS5tb250aHMgPCAxMCA/ICcwJyArICRzY29wZS5tb250aHMgOiAkc2NvcGUubW9udGhzO1xuICAgICAgICAgICRzY29wZS55eWVhcnMgPSAkc2NvcGUueWVhcnMgPCAxMCA/ICcwJyArICRzY29wZS55ZWFycyA6ICRzY29wZS55ZWFycztcblxuICAgICAgICB9XG5cbiAgICAgICAgLy9kZXRlcm1pbmUgaW5pdGlhbCB2YWx1ZXMgb2YgdGltZSB1bml0cyBhbmQgYWRkIEFkZFNlY29uZHMgZnVuY3Rpb25hbGl0eVxuICAgICAgICBpZiAoJHNjb3BlLmNvdW50ZG93bmF0dHIpIHtcbiAgICAgICAgICAkc2NvcGUubWlsbGlzID0gJHNjb3BlLmNvdW50ZG93bmF0dHIgKiAxMDAwO1xuXG4gICAgICAgICAgJHNjb3BlLmFkZENEU2Vjb25kcyA9IGZ1bmN0aW9uIChleHRyYVNlY29uZHMpIHtcbiAgICAgICAgICAgICRzY29wZS5jb3VudGRvd24gKz0gZXh0cmFTZWNvbmRzO1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUuaXNSdW5uaW5nKSB7XG4gICAgICAgICAgICAgICRzY29wZS5zdGFydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG5cbiAgICAgICAgICAkc2NvcGUuJG9uKCd0aW1lci1hZGQtY2Qtc2Vjb25kcycsIGZ1bmN0aW9uIChlLCBleHRyYVNlY29uZHMpIHtcbiAgICAgICAgICAgICAkc2NvcGUuYWRkQ0RTZWNvbmRzKGV4dHJhU2Vjb25kcyk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAkc2NvcGUuJG9uKCd0aW1lci1zZXQtY291bnRkb3duLXNlY29uZHMnLCBmdW5jdGlvbiAoZSwgY291bnRkb3duU2Vjb25kcykge1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUuaXNSdW5uaW5nKSB7XG4gICAgICAgICAgICAgICRzY29wZS5jbGVhcigpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuY291bnRkb3duID0gY291bnRkb3duU2Vjb25kcztcbiAgICAgICAgICAgICRzY29wZS5taWxsaXMgPSBjb3VudGRvd25TZWNvbmRzICogMTAwMDtcbiAgICAgICAgICAgIGNhbGN1bGF0ZVRpbWVVbml0cygpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICRzY29wZS5taWxsaXMgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGNhbGN1bGF0ZVRpbWVVbml0cygpO1xuXG4gICAgICAgIHZhciB0aWNrID0gZnVuY3Rpb24gdGljaygpIHtcbiAgICAgICAgICB2YXIgdHlwZVRpbWVyID0gbnVsbDsgLy8gY291bnRkb3duIG9yIGVuZFRpbWVBdHRyXG4gICAgICAgICAgJHNjb3BlLm1pbGxpcyA9IG1vbWVudCgpLmRpZmYoJHNjb3BlLnN0YXJ0VGltZSk7XG4gICAgICAgICAgdmFyIGFkanVzdG1lbnQgPSAkc2NvcGUubWlsbGlzICUgMTAwMDtcblxuICAgICAgICAgIGlmICgkc2NvcGUuZW5kVGltZUF0dHIpIHtcbiAgICAgICAgICAgIHR5cGVUaW1lciA9ICRzY29wZS5lbmRUaW1lQXR0cjtcbiAgICAgICAgICAgICRzY29wZS5taWxsaXMgPSBtb21lbnQoJHNjb3BlLmVuZFRpbWUpLmRpZmYobW9tZW50KCkpO1xuICAgICAgICAgICAgYWRqdXN0bWVudCA9ICRzY29wZS5pbnRlcnZhbCAtICRzY29wZS5taWxsaXMgJSAxMDAwO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICgkc2NvcGUuY291bnRkb3duYXR0cikge1xuICAgICAgICAgICAgdHlwZVRpbWVyID0gJHNjb3BlLmNvdW50ZG93bmF0dHI7XG4gICAgICAgICAgICAkc2NvcGUubWlsbGlzID0gJHNjb3BlLmNvdW50ZG93biAqIDEwMDA7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCRzY29wZS5taWxsaXMgPCAwKSB7XG4gICAgICAgICAgICAkc2NvcGUuc3RvcCgpO1xuICAgICAgICAgICAgJHNjb3BlLm1pbGxpcyA9IDA7XG4gICAgICAgICAgICBjYWxjdWxhdGVUaW1lVW5pdHMoKTtcbiAgICAgICAgICAgIGlmKCRzY29wZS5maW5pc2hDYWxsYmFjaykge1xuICAgICAgICAgICAgICAkc2NvcGUuJGV2YWwoJHNjb3BlLmZpbmlzaENhbGxiYWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FsY3VsYXRlVGltZVVuaXRzKCk7XG5cbiAgICAgICAgICAvL1dlIGFyZSBub3QgdXNpbmcgJHRpbWVvdXQgZm9yIGEgcmVhc29uLiBQbGVhc2UgcmVhZCBoZXJlIC0gaHR0cHM6Ly9naXRodWIuY29tL3NpZGRpaS9hbmd1bGFyLXRpbWVyL3B1bGwvNVxuICAgICAgICAgICRzY29wZS50aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgdGljaygpO1xuICAgICAgICAgICAgICAvLyBzaW5jZSB5b3UgY2hvb3NlIG5vdCB0byB1c2UgJHRpbWVvdXQsIGF0IGxlYXN0IHByZXNlcnZlIGFuZ3VsYXIgY3ljbGUgdHdvIHdheSBkYXRhIGJpbmRpbmdcbiAgICAgICAgICAgICAgLy8gYnkgY2FsbGluZyAkc2NvcGUuJGFwcGx5KCkgaW5zdGVhZCBvZiAkc2NvcGUuJGRpZ2VzdCgpXG4gICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAgICAgICB9LCAkc2NvcGUuaW50ZXJ2YWwgLSBhZGp1c3RtZW50KTtcblxuICAgICAgICAgICRzY29wZS4kZW1pdCgndGltZXItdGljaycsIHtcbiAgICAgICAgICAgIHRpbWVvdXRJZDogJHNjb3BlLnRpbWVvdXRJZCxcbiAgICAgICAgICAgIG1pbGxpczogJHNjb3BlLm1pbGxpcyxcbiAgICAgICAgICAgIHNlY29uZHM6ICRzY29wZS5zZWNvbmRzLFxuICAgICAgICAgICAgbWludXRlczogJHNjb3BlLm1pbnV0ZXMsXG4gICAgICAgICAgICBob3VyczogJHNjb3BlLmhvdXJzLFxuICAgICAgICAgICAgZGF5czogJHNjb3BlLmRheXNcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGlmICgkc2NvcGUuY291bnRkb3duID4gMCkge1xuICAgICAgICAgICAgJHNjb3BlLmNvdW50ZG93bi0tO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmICgkc2NvcGUuY291bnRkb3duIDw9IDApIHtcbiAgICAgICAgICAgICRzY29wZS5zdG9wKCk7XG4gICAgICAgICAgICBpZigkc2NvcGUuZmluaXNoQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgJHNjb3BlLiRldmFsKCRzY29wZS5maW5pc2hDYWxsYmFjayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYodHlwZVRpbWVyICE9PSBudWxsKXtcbiAgICAgICAgICAgIC8vY2FsY3VsYXRlIHByb2dyZXNzIGJhclxuICAgICAgICAgICAgJHNjb3BlLnByb2dyZXNzQmFyID0gcHJvZ3Jlc3NCYXJTZXJ2aWNlLmNhbGN1bGF0ZVByb2dyZXNzQmFyKCRzY29wZS5zdGFydFRpbWUsICRzY29wZS5taWxsaXMsICRzY29wZS5lbmRUaW1lLCAkc2NvcGUuY291bnRkb3duYXR0cik7XG5cbiAgICAgICAgICAgIGlmKCRzY29wZS5wcm9ncmVzc0JhciA9PT0gMTAwKXtcbiAgICAgICAgICAgICAgJHNjb3BlLmRpc3BsYXlQcm9ncmVzc0FjdGl2ZSA9ICcnOyAvL05vIG1vcmUgQm9vdHN0cmFwIGFjdGl2ZSBlZmZlY3RcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKCRzY29wZS5hdXRvU3RhcnQgPT09IHVuZGVmaW5lZCB8fCAkc2NvcGUuYXV0b1N0YXJ0ID09PSB0cnVlKSB7XG4gICAgICAgICAgJHNjb3BlLnN0YXJ0KCk7XG4gICAgICAgIH1cbiAgICAgIH1dXG4gICAgfTtcbiAgfV0pXG4gIC5kaXJlY3RpdmUoJ3RpbWVyQ29udHJvbHMnLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgICBzY29wZTogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gICAgICAgICRzY29wZS50aW1lclN0YXR1cyA9IFwicmVzZXRcIjtcbiAgICAgICAgJHNjb3BlLiRvbigndGltZXItc3RhcnRlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRzY29wZS50aW1lclN0YXR1cyA9IFwic3RhcnRlZFwiO1xuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLiRvbigndGltZXItc3RvcHBlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRzY29wZS50aW1lclN0YXR1cyA9IFwic3RvcHBlZFwiO1xuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLiRvbigndGltZXItcmVzZXQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkc2NvcGUudGltZXJTdGF0dXMgPSBcInJlc2V0XCI7XG4gICAgICAgIH0pO1xuICAgICAgICAkc2NvcGUudGltZXJTdGFydCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCd0aW1lci1zdGFydCcpO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUudGltZXJTdG9wID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ3RpbWVyLXN0b3AnKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnRpbWVyUmVzdW1lID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ3RpbWVyLXJlc3VtZScpO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUudGltZXJUb2dnbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBzd2l0Y2ggKCRzY29wZS50aW1lclN0YXR1cykge1xuICAgICAgICAgICAgY2FzZSBcInN0YXJ0ZWRcIjpcbiAgICAgICAgICAgICAgJHNjb3BlLnRpbWVyU3RvcCgpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzdG9wcGVkXCI6XG4gICAgICAgICAgICAgICRzY29wZS50aW1lclJlc3VtZSgpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJyZXNldFwiOlxuICAgICAgICAgICAgICAkc2NvcGUudGltZXJTdGFydCgpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS50aW1lckFkZENEU2Vjb25kcyA9IGZ1bmN0aW9uKGV4dHJhU2Vjb25kcykge1xuICAgICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCd0aW1lci1hZGQtY2Qtc2Vjb25kcycsIGV4dHJhU2Vjb25kcyk7XG4gICAgICAgIH07XG4gICAgICB9XVxuICAgIH07XG4gIH0pO1xuXG4vKiBjb21tb25qcyBwYWNrYWdlIG1hbmFnZXIgc3VwcG9ydCAoZWcgY29tcG9uZW50anMpICovXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgZXhwb3J0cyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBtb2R1bGUuZXhwb3J0cyA9PT0gZXhwb3J0cyl7XG4gIG1vZHVsZS5leHBvcnRzID0gdGltZXJNb2R1bGU7XG59XG5cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgndGltZXInKTtcblxuYXBwLmZhY3RvcnkoJ0kxOG5TZXJ2aWNlJywgZnVuY3Rpb24oKSB7XG5cbiAgICB2YXIgSTE4blNlcnZpY2UgPSBmdW5jdGlvbigpIHt9O1xuXG4gICAgSTE4blNlcnZpY2UucHJvdG90eXBlLmxhbmd1YWdlID0gJ2VuJztcbiAgICBJMThuU2VydmljZS5wcm90b3R5cGUuZmFsbGJhY2sgPSAnZW4nO1xuICAgIEkxOG5TZXJ2aWNlLnByb3RvdHlwZS50aW1lSHVtYW5pemVyID0ge307XG5cbiAgICBJMThuU2VydmljZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIGluaXQobGFuZywgZmFsbGJhY2spIHtcbiAgICAgICAgdmFyIHN1cHBvcnRlZF9sYW5ndWFnZXMgPSBodW1hbml6ZUR1cmF0aW9uLmdldFN1cHBvcnRlZExhbmd1YWdlcygpO1xuXG4gICAgICAgIHRoaXMuZmFsbGJhY2sgPSAoZmFsbGJhY2sgIT09IHVuZGVmaW5lZCkgPyBmYWxsYmFjayA6ICdlbic7XG4gICAgICAgIGlmIChzdXBwb3J0ZWRfbGFuZ3VhZ2VzLmluZGV4T2YoZmFsbGJhY2spID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5mYWxsYmFjayA9ICdlbic7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmxhbmd1YWdlID0gbGFuZztcbiAgICAgICAgaWYgKHN1cHBvcnRlZF9sYW5ndWFnZXMuaW5kZXhPZihsYW5nKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMubGFuZ3VhZ2UgPSB0aGlzLmZhbGxiYWNrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSXQgc2hvdWxkIGJlIGhhbmRsZSBieSB0aGUgdXNlcidzIGFwcGxpY2F0aW9uIGl0c2VsZiwgYW5kIG5vdCBpbnNpZGUgdGhlIGRpcmVjdGl2ZVxuICAgICAgICAvLyBtb21lbnQgaW5pdFxuICAgICAgICAvLyBtb21lbnQubG9jYWxlKHRoaXMubGFuZ3VhZ2UpO1xuXG4gICAgICAgIC8vaHVtYW4gZHVyYXRpb24gaW5pdCwgdXNpbmcgaXQgYmVjYXVzZSBtb21lbnRqcyBkb2VzIG5vdCBhbGxvdyBhY2N1cmF0ZSB0aW1lIChcbiAgICAgICAgLy8gbW9tZW50SlM6IGEgZmV3IG1vbWVudCBhZ28sIGh1bWFuIGR1cmF0aW9uIDogNCBzZWNvbmRzIGFnb1xuICAgICAgICB0aGlzLnRpbWVIdW1hbml6ZXIgPSBodW1hbml6ZUR1cmF0aW9uLmh1bWFuaXplcih7XG4gICAgICAgICAgICBsYW5ndWFnZTogdGhpcy5sYW5ndWFnZSxcbiAgICAgICAgICAgIGhhbGZVbml0OmZhbHNlXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBnZXQgdGltZSB3aXRoIHVuaXRzIGZyb20gbW9tZW50SlMgaTE4blxuICAgICAqIEBwYXJhbSB7aW50fSBtaWxsaXNcbiAgICAgKiBAcmV0dXJucyB7e21pbGxpczogc3RyaW5nLCBzZWNvbmRzOiBzdHJpbmcsIG1pbnV0ZXM6IHN0cmluZywgaG91cnM6IHN0cmluZywgZGF5czogc3RyaW5nLCBtb250aHM6IHN0cmluZywgeWVhcnM6IHN0cmluZ319XG4gICAgICovXG4gICAgSTE4blNlcnZpY2UucHJvdG90eXBlLmdldFRpbWVVbml0cyA9IGZ1bmN0aW9uIGdldFRpbWVVbml0cyhtaWxsaXMpIHtcbiAgICAgICAgdmFyIGRpZmZGcm9tQWxhcm0gPSBNYXRoLnJvdW5kKG1pbGxpcy8xMDAwKSAqIDEwMDA7IC8vdGltZSBpbiBtaWxsaXNlY29uZHMsIGdldCByaWQgb2YgdGhlIGxhc3QgMyBtcyB2YWx1ZSB0byBhdm9pZCAyLjEyIHNlY29uZHMgZGlzcGxheVxuXG4gICAgICAgIHZhciB0aW1lID0ge307XG5cbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnRpbWVIdW1hbml6ZXIgIT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICAgICAgdGltZSA9IHtcbiAgICAgICAgICAgICAgICAnbWlsbGlzJyA6IHRoaXMudGltZUh1bWFuaXplcihkaWZmRnJvbUFsYXJtLCB7IHVuaXRzOiBbXCJtc1wiXSB9KSxcbiAgICAgICAgICAgICAgICAnc2Vjb25kcycgOiB0aGlzLnRpbWVIdW1hbml6ZXIoZGlmZkZyb21BbGFybSwgeyB1bml0czogW1wic1wiXSB9KSxcbiAgICAgICAgICAgICAgICAnbWludXRlcycgOiB0aGlzLnRpbWVIdW1hbml6ZXIoZGlmZkZyb21BbGFybSwgeyB1bml0czogW1wibVwiLCBcInNcIl0gfSkgLFxuICAgICAgICAgICAgICAgICdob3VycycgOiB0aGlzLnRpbWVIdW1hbml6ZXIoZGlmZkZyb21BbGFybSwgeyB1bml0czogW1wiaFwiLCBcIm1cIiwgXCJzXCJdIH0pICxcbiAgICAgICAgICAgICAgICAnZGF5cycgOiB0aGlzLnRpbWVIdW1hbml6ZXIoZGlmZkZyb21BbGFybSwgeyB1bml0czogW1wiZFwiLCBcImhcIiwgXCJtXCIsIFwic1wiXSB9KSAsXG4gICAgICAgICAgICAgICAgJ21vbnRocycgOiB0aGlzLnRpbWVIdW1hbml6ZXIoZGlmZkZyb21BbGFybSwgeyB1bml0czogW1wibW9cIiwgXCJkXCIsIFwiaFwiLCBcIm1cIiwgXCJzXCJdIH0pICxcbiAgICAgICAgICAgICAgICAneWVhcnMnIDogdGhpcy50aW1lSHVtYW5pemVyKGRpZmZGcm9tQWxhcm0sIHsgdW5pdHM6IFtcInlcIiwgXCJtb1wiLCBcImRcIiwgXCJoXCIsIFwibVwiLCBcInNcIl0gfSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdpMThuU2VydmljZSBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuIFlvdSBtdXN0IGNhbGwgaTE4blNlcnZpY2UuaW5pdChcImVuXCIpIGZvciBleGFtcGxlJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGltZTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEkxOG5TZXJ2aWNlO1xufSk7XG5cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgndGltZXInKTtcblxuYXBwLmZhY3RvcnkoJ3Byb2dyZXNzQmFyU2VydmljZScsIGZ1bmN0aW9uKCkge1xuXG4gIHZhciBQcm9ncmVzc0JhclNlcnZpY2UgPSBmdW5jdGlvbigpIHt9O1xuXG4gIC8qKlxuICAgKiBjYWxjdWxhdGUgdGhlIHJlbWFpbmluZyB0aW1lIGluIGEgcHJvZ3Jlc3MgYmFyIGluIHBlcmNlbnRhZ2VcbiAgICogQHBhcmFtIHttb21lbnRqc30gc3RhcnRWYWx1ZSBpbiBzZWNvbmRzXG4gICAqIEBwYXJhbSB7aW50ZWdlcn0gY3VycmVudENvdW50ZG93biwgd2hlcmUgYXJlIHdlIGluIHRoZSBjb3VudGRvd25cbiAgICogQHBhcmFtIHtpbnRlZ2VyfSByZW1haW5pbmdUaW1lLCByZW1haW5pbmcgbWlsbGlzZWNvbmRzXG4gICAqIEBwYXJhbSB7aW50ZWdlcn0gZW5kVGltZSwgZW5kIHRpbWUsIGNhbiBiZSB1bmRlZmluZWRcbiAgICogQHBhcmFtIHtpbnRlZ2VyfSBjb3V0ZG93biwgb3JpZ2luYWwgY291dGRvd24gdmFsdWUsIGNhbiBiZSB1bmRlZmluZWRcbiAgICpcbiAgICogam9rZSA6IGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9Z0VOVkI2dGpxX01cbiAgICogQHJldHVybiB7ZmxvYXR9IDAgLS0+IDEwMFxuICAgKi9cbiAgUHJvZ3Jlc3NCYXJTZXJ2aWNlLnByb3RvdHlwZS5jYWxjdWxhdGVQcm9ncmVzc0JhciA9IGZ1bmN0aW9uIGNhbGN1bGF0ZVByb2dyZXNzQmFyKHN0YXJ0VmFsdWUsIHJlbWFpbmluZ1RpbWUsIGVuZFRpbWVBdHRyLCBjb3V0ZG93bikge1xuICAgIHZhciBkaXNwbGF5UHJvZ3Jlc3NCYXIgPSAwLFxuICAgICAgZW5kVGltZVZhbHVlLFxuICAgICAgaW5pdGlhbENvdW50ZG93bjtcblxuICAgIHJlbWFpbmluZ1RpbWUgPSByZW1haW5pbmdUaW1lIC8gMTAwMDsgLy9zZWNvbmRzXG5cblxuICAgIGlmKGVuZFRpbWVBdHRyICE9PSBudWxsKXtcbiAgICAgIGVuZFRpbWVWYWx1ZSA9IG1vbWVudChlbmRUaW1lQXR0cik7XG4gICAgICBpbml0aWFsQ291bnRkb3duID0gZW5kVGltZVZhbHVlLmRpZmYoc3RhcnRWYWx1ZSwgJ3NlY29uZHMnKTtcbiAgICAgIGRpc3BsYXlQcm9ncmVzc0JhciA9IHJlbWFpbmluZ1RpbWUgKiAxMDAgLyBpbml0aWFsQ291bnRkb3duO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGRpc3BsYXlQcm9ncmVzc0JhciA9IHJlbWFpbmluZ1RpbWUgKiAxMDAgLyBjb3V0ZG93bjtcbiAgICB9XG5cbiAgICBkaXNwbGF5UHJvZ3Jlc3NCYXIgPSAxMDAgLSBkaXNwbGF5UHJvZ3Jlc3NCYXI7IC8vVG8gaGF2ZSAwIHRvIDEwMCBhbmQgbm90IDEwMCB0byAwXG4gICAgZGlzcGxheVByb2dyZXNzQmFyID0gTWF0aC5yb3VuZChkaXNwbGF5UHJvZ3Jlc3NCYXIgKiAxMCkgLyAxMDsgLy9sZWFybiBtb3JlIHdoeSA6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNTg4MDA0L2lzLWZsb2F0aW5nLXBvaW50LW1hdGgtYnJva2VuXG5cbiAgICBpZihkaXNwbGF5UHJvZ3Jlc3NCYXIgPiAxMDApeyAvL3NlY3VyaXR5XG4gICAgICBkaXNwbGF5UHJvZ3Jlc3NCYXIgPSAxMDA7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRpc3BsYXlQcm9ncmVzc0JhcjtcbiAgfTtcblxuICByZXR1cm4gbmV3IFByb2dyZXNzQmFyU2VydmljZSgpO1xufSk7XG4iXX0=
