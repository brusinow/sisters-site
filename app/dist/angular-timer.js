var timerModule=angular.module("timer",[]).directive("timer",["$compile",function($compile){return{restrict:"EA",replace:!1,scope:{interval:"=interval",startTimeAttr:"=startTime",endTimeAttr:"=endTime",countdownattr:"=countdown",finishCallback:"&finishCallback",autoStart:"&autoStart",language:"@?",fallback:"@?",maxTimeUnit:"=",seconds:"=?",minutes:"=?",hours:"=?",days:"=?",months:"=?",years:"=?",secondsS:"=?",minutesS:"=?",hoursS:"=?",daysS:"=?",monthsS:"=?",yearsS:"=?"},controller:["$scope","$element","$attrs","$timeout","I18nService","$interpolate","progressBarService",function($scope,$element,$attrs,$timeout,I18nService,$interpolate,progressBarService){function resetTimeout(){$scope.timeoutId&&clearTimeout($scope.timeoutId)}function calculateTimeUnits(){var timeUnits={};void 0!==$attrs.startTime&&($scope.millis=moment().diff(moment($scope.startTimeAttr))),timeUnits=i18nService.getTimeUnits($scope.millis),$scope.maxTimeUnit&&"day"!==$scope.maxTimeUnit?"second"===$scope.maxTimeUnit?($scope.seconds=Math.floor($scope.millis/1e3),$scope.minutes=0,$scope.hours=0,$scope.days=0,$scope.months=0,$scope.years=0):"minute"===$scope.maxTimeUnit?($scope.seconds=Math.floor($scope.millis/1e3%60),$scope.minutes=Math.floor($scope.millis/6e4),$scope.hours=0,$scope.days=0,$scope.months=0,$scope.years=0):"hour"===$scope.maxTimeUnit?($scope.seconds=Math.floor($scope.millis/1e3%60),$scope.minutes=Math.floor($scope.millis/6e4%60),$scope.hours=Math.floor($scope.millis/36e5),$scope.days=0,$scope.months=0,$scope.years=0):"month"===$scope.maxTimeUnit?($scope.seconds=Math.floor($scope.millis/1e3%60),$scope.minutes=Math.floor($scope.millis/6e4%60),$scope.hours=Math.floor($scope.millis/36e5%24),$scope.days=Math.floor($scope.millis/36e5/24%30),$scope.months=Math.floor($scope.millis/36e5/24/30),$scope.years=0):"year"===$scope.maxTimeUnit&&($scope.seconds=Math.floor($scope.millis/1e3%60),$scope.minutes=Math.floor($scope.millis/6e4%60),$scope.hours=Math.floor($scope.millis/36e5%24),$scope.days=Math.floor($scope.millis/36e5/24%30),$scope.months=Math.floor($scope.millis/36e5/24/30%12),$scope.years=Math.floor($scope.millis/36e5/24/365)):($scope.seconds=Math.floor($scope.millis/1e3%60),$scope.minutes=Math.floor($scope.millis/6e4%60),$scope.hours=Math.floor($scope.millis/36e5%24),$scope.days=Math.floor($scope.millis/36e5/24),$scope.months=0,$scope.years=0),$scope.secondsS=1===$scope.seconds?"":"s",$scope.minutesS=1===$scope.minutes?"":"s",$scope.hoursS=1===$scope.hours?"":"s",$scope.daysS=1===$scope.days?"":"s",$scope.monthsS=1===$scope.months?"":"s",$scope.yearsS=1===$scope.years?"":"s",$scope.secondUnit=timeUnits.seconds,$scope.minuteUnit=timeUnits.minutes,$scope.hourUnit=timeUnits.hours,$scope.dayUnit=timeUnits.days,$scope.monthUnit=timeUnits.months,$scope.yearUnit=timeUnits.years,$scope.sseconds=$scope.seconds<10?"0"+$scope.seconds:$scope.seconds,$scope.mminutes=$scope.minutes<10?"0"+$scope.minutes:$scope.minutes,$scope.hhours=$scope.hours<10?"0"+$scope.hours:$scope.hours,$scope.ddays=$scope.days<10?"0"+$scope.days:$scope.days,$scope.mmonths=$scope.months<10?"0"+$scope.months:$scope.months,$scope.yyears=$scope.years<10?"0"+$scope.years:$scope.years}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),$scope.autoStart=$attrs.autoStart||$attrs.autostart,$scope.language=$scope.language||"en",$scope.fallback=$scope.fallback||"en",$scope.$watch("language",function(newVal,oldVal){void 0!==newVal&&i18nService.init(newVal,$scope.fallback)});var i18nService=new I18nService;i18nService.init($scope.language,$scope.fallback),$scope.displayProgressBar=0,$scope.displayProgressActive="active",0===$element.html().trim().length?$element.append($compile("<span>"+$interpolate.startSymbol()+"millis"+$interpolate.endSymbol()+"</span>")($scope)):$element.append($compile($element.contents())($scope)),$scope.startTime=null,$scope.endTime=null,$scope.timeoutId=null,$scope.countdown=angular.isNumber($scope.countdownattr)&&parseInt($scope.countdownattr,10)>=0?parseInt($scope.countdownattr,10):void 0,$scope.isRunning=!1,$scope.$on("timer-start",function(){$scope.start()}),$scope.$on("timer-resume",function(){$scope.resume()}),$scope.$on("timer-stop",function(){$scope.stop()}),$scope.$on("timer-clear",function(){$scope.clear()}),$scope.$on("timer-reset",function(){$scope.reset()}),$scope.$on("timer-set-countdown",function(e,countdown){$scope.countdown=countdown}),$scope.$watch("startTimeAttr",function(newValue,oldValue){newValue!==oldValue&&$scope.isRunning&&$scope.start()}),$scope.$watch("endTimeAttr",function(newValue,oldValue){newValue!==oldValue&&$scope.isRunning&&$scope.start()}),$scope.start=function(){$scope.startTime=$scope.startTimeAttr?moment($scope.startTimeAttr):moment(),$scope.endTime=$scope.endTimeAttr?moment($scope.endTimeAttr):null,angular.isNumber($scope.countdown)||($scope.countdown=angular.isNumber($scope.countdownattr)&&parseInt($scope.countdownattr,10)>0?parseInt($scope.countdownattr,10):void 0),resetTimeout(),tick(),$scope.isRunning=!0,$scope.$emit("timer-started",{timeoutId:$scope.timeoutId,millis:$scope.millis,seconds:$scope.seconds,minutes:$scope.minutes,hours:$scope.hours,days:$scope.days})},$scope.resume=function(){resetTimeout(),$scope.countdownattr&&($scope.countdown+=1),$scope.startTime=moment().diff(moment($scope.stoppedTime).diff(moment($scope.startTime))),tick(),$scope.isRunning=!0,$scope.$emit("timer-started",{timeoutId:$scope.timeoutId,millis:$scope.millis,seconds:$scope.seconds,minutes:$scope.minutes,hours:$scope.hours,days:$scope.days})},$scope.stop=$scope.pause=function(){var timeoutId=$scope.timeoutId;$scope.clear(),$scope.$emit("timer-stopped",{timeoutId:timeoutId,millis:$scope.millis,seconds:$scope.seconds,minutes:$scope.minutes,hours:$scope.hours,days:$scope.days})},$scope.clear=function(){$scope.stoppedTime=moment(),resetTimeout(),$scope.timeoutId=null,$scope.isRunning=!1},$scope.reset=function(){$scope.startTime=$scope.startTimeAttr?moment($scope.startTimeAttr):moment(),$scope.endTime=$scope.endTimeAttr?moment($scope.endTimeAttr):null,$scope.countdown=angular.isNumber($scope.countdownattr)&&parseInt($scope.countdownattr,10)>0?parseInt($scope.countdownattr,10):void 0,resetTimeout(),tick(),$scope.isRunning=!1,$scope.clear(),$scope.$emit("timer-reset",{timeoutId:timeoutId,millis:$scope.millis,seconds:$scope.seconds,minutes:$scope.minutes,hours:$scope.hours,days:$scope.days})},$element.bind("$destroy",function(){resetTimeout(),$scope.isRunning=!1}),$scope.countdownattr?($scope.millis=1e3*$scope.countdownattr,$scope.addCDSeconds=function(extraSeconds){$scope.countdown+=extraSeconds,$scope.isRunning||$scope.start()},$scope.$on("timer-add-cd-seconds",function(e,extraSeconds){$scope.addCDSeconds(extraSeconds)}),$scope.$on("timer-set-countdown-seconds",function(e,countdownSeconds){$scope.isRunning||$scope.clear(),$scope.countdown=countdownSeconds,$scope.millis=1e3*countdownSeconds,calculateTimeUnits()})):$scope.millis=0,calculateTimeUnits();var tick=function tick(){var typeTimer=null;$scope.millis=moment().diff($scope.startTime);var adjustment=$scope.millis%1e3;return $scope.endTimeAttr&&(typeTimer=$scope.endTimeAttr,$scope.millis=moment($scope.endTime).diff(moment()),adjustment=$scope.interval-$scope.millis%1e3),$scope.countdownattr&&(typeTimer=$scope.countdownattr,$scope.millis=1e3*$scope.countdown),$scope.millis<0?($scope.stop(),$scope.millis=0,calculateTimeUnits(),void($scope.finishCallback&&$scope.$eval($scope.finishCallback))):(calculateTimeUnits(),$scope.timeoutId=setTimeout(function(){tick(),$scope.$apply()},$scope.interval-adjustment),$scope.$emit("timer-tick",{timeoutId:$scope.timeoutId,millis:$scope.millis,seconds:$scope.seconds,minutes:$scope.minutes,hours:$scope.hours,days:$scope.days}),$scope.countdown>0?$scope.countdown--:$scope.countdown<=0&&($scope.stop(),$scope.finishCallback&&$scope.$eval($scope.finishCallback)),void(null!==typeTimer&&($scope.progressBar=progressBarService.calculateProgressBar($scope.startTime,$scope.millis,$scope.endTime,$scope.countdownattr),100===$scope.progressBar&&($scope.displayProgressActive=""))))};void 0!==$scope.autoStart&&$scope.autoStart!==!0||$scope.start()}]}}]).directive("timerControls",function(){return{restrict:"EA",scope:!0,controller:["$scope",function($scope){$scope.timerStatus="reset",$scope.$on("timer-started",function(){$scope.timerStatus="started"}),$scope.$on("timer-stopped",function(){$scope.timerStatus="stopped"}),$scope.$on("timer-reset",function(){$scope.timerStatus="reset"}),$scope.timerStart=function(){$scope.$broadcast("timer-start")},$scope.timerStop=function(){$scope.$broadcast("timer-stop")},$scope.timerResume=function(){$scope.$broadcast("timer-resume")},$scope.timerToggle=function(){switch($scope.timerStatus){case"started":$scope.timerStop();break;case"stopped":$scope.timerResume();break;case"reset":$scope.timerStart()}},$scope.timerAddCDSeconds=function(extraSeconds){$scope.$broadcast("timer-add-cd-seconds",extraSeconds)}}]}});"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports=timerModule);var app=angular.module("timer");app.factory("I18nService",function(){var I18nService=function(){};return I18nService.prototype.language="en",I18nService.prototype.fallback="en",I18nService.prototype.timeHumanizer={},I18nService.prototype.init=function(lang,fallback){var supported_languages=humanizeDuration.getSupportedLanguages();this.fallback=void 0!==fallback?fallback:"en",supported_languages.indexOf(fallback)===-1&&(this.fallback="en"),this.language=lang,supported_languages.indexOf(lang)===-1&&(this.language=this.fallback),this.timeHumanizer=humanizeDuration.humanizer({language:this.language,halfUnit:!1})},I18nService.prototype.getTimeUnits=function(millis){var diffFromAlarm=1e3*Math.round(millis/1e3),time={};return"undefined"!=typeof this.timeHumanizer?time={millis:this.timeHumanizer(diffFromAlarm,{units:["ms"]}),seconds:this.timeHumanizer(diffFromAlarm,{units:["s"]}),minutes:this.timeHumanizer(diffFromAlarm,{units:["m","s"]}),hours:this.timeHumanizer(diffFromAlarm,{units:["h","m","s"]}),days:this.timeHumanizer(diffFromAlarm,{units:["d","h","m","s"]}),months:this.timeHumanizer(diffFromAlarm,{units:["mo","d","h","m","s"]}),years:this.timeHumanizer(diffFromAlarm,{units:["y","mo","d","h","m","s"]})}:console.error('i18nService has not been initialized. You must call i18nService.init("en") for example'),time},I18nService});var app=angular.module("timer");app.factory("progressBarService",function(){var ProgressBarService=function(){};return ProgressBarService.prototype.calculateProgressBar=function(startValue,remainingTime,endTimeAttr,coutdown){var endTimeValue,initialCountdown,displayProgressBar=0;return remainingTime/=1e3,null!==endTimeAttr?(endTimeValue=moment(endTimeAttr),initialCountdown=endTimeValue.diff(startValue,"seconds"),displayProgressBar=100*remainingTime/initialCountdown):displayProgressBar=100*remainingTime/coutdown,displayProgressBar=100-displayProgressBar,displayProgressBar=Math.round(10*displayProgressBar)/10,displayProgressBar>100&&(displayProgressBar=100),displayProgressBar},new ProgressBarService});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuZ3VsYXItdGltZXIuanMiXSwibmFtZXMiOlsidGltZXJNb2R1bGUiLCJhbmd1bGFyIiwibW9kdWxlIiwiZGlyZWN0aXZlIiwiJGNvbXBpbGUiLCJyZXN0cmljdCIsInJlcGxhY2UiLCJzY29wZSIsImludGVydmFsIiwic3RhcnRUaW1lQXR0ciIsImVuZFRpbWVBdHRyIiwiY291bnRkb3duYXR0ciIsImZpbmlzaENhbGxiYWNrIiwiYXV0b1N0YXJ0IiwibGFuZ3VhZ2UiLCJmYWxsYmFjayIsIm1heFRpbWVVbml0Iiwic2Vjb25kcyIsIm1pbnV0ZXMiLCJob3VycyIsImRheXMiLCJtb250aHMiLCJ5ZWFycyIsInNlY29uZHNTIiwibWludXRlc1MiLCJob3Vyc1MiLCJkYXlzUyIsIm1vbnRoc1MiLCJ5ZWFyc1MiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiJGVsZW1lbnQiLCIkYXR0cnMiLCIkdGltZW91dCIsIkkxOG5TZXJ2aWNlIiwiJGludGVycG9sYXRlIiwicHJvZ3Jlc3NCYXJTZXJ2aWNlIiwicmVzZXRUaW1lb3V0IiwidGltZW91dElkIiwiY2xlYXJUaW1lb3V0IiwiY2FsY3VsYXRlVGltZVVuaXRzIiwidGltZVVuaXRzIiwidW5kZWZpbmVkIiwic3RhcnRUaW1lIiwibWlsbGlzIiwibW9tZW50IiwiZGlmZiIsImkxOG5TZXJ2aWNlIiwiZ2V0VGltZVVuaXRzIiwiTWF0aCIsImZsb29yIiwic2Vjb25kVW5pdCIsIm1pbnV0ZVVuaXQiLCJob3VyVW5pdCIsImRheVVuaXQiLCJtb250aFVuaXQiLCJ5ZWFyVW5pdCIsInNzZWNvbmRzIiwibW1pbnV0ZXMiLCJoaG91cnMiLCJkZGF5cyIsIm1tb250aHMiLCJ5eWVhcnMiLCJTdHJpbmciLCJwcm90b3R5cGUiLCJ0cmltIiwidGhpcyIsImF1dG9zdGFydCIsIiR3YXRjaCIsIm5ld1ZhbCIsIm9sZFZhbCIsImluaXQiLCJkaXNwbGF5UHJvZ3Jlc3NCYXIiLCJkaXNwbGF5UHJvZ3Jlc3NBY3RpdmUiLCJodG1sIiwibGVuZ3RoIiwiYXBwZW5kIiwic3RhcnRTeW1ib2wiLCJlbmRTeW1ib2wiLCJjb250ZW50cyIsImVuZFRpbWUiLCJjb3VudGRvd24iLCJpc051bWJlciIsInBhcnNlSW50IiwiaXNSdW5uaW5nIiwiJG9uIiwic3RhcnQiLCJyZXN1bWUiLCJzdG9wIiwiY2xlYXIiLCJyZXNldCIsImUiLCJuZXdWYWx1ZSIsIm9sZFZhbHVlIiwidGljayIsIiRlbWl0Iiwic3RvcHBlZFRpbWUiLCJwYXVzZSIsImJpbmQiLCJhZGRDRFNlY29uZHMiLCJleHRyYVNlY29uZHMiLCJjb3VudGRvd25TZWNvbmRzIiwidHlwZVRpbWVyIiwiYWRqdXN0bWVudCIsIiRldmFsIiwic2V0VGltZW91dCIsIiRhcHBseSIsInByb2dyZXNzQmFyIiwiY2FsY3VsYXRlUHJvZ3Jlc3NCYXIiLCJ0aW1lclN0YXR1cyIsInRpbWVyU3RhcnQiLCIkYnJvYWRjYXN0IiwidGltZXJTdG9wIiwidGltZXJSZXN1bWUiLCJ0aW1lclRvZ2dsZSIsInRpbWVyQWRkQ0RTZWNvbmRzIiwiZXhwb3J0cyIsImFwcCIsImZhY3RvcnkiLCJ0aW1lSHVtYW5pemVyIiwibGFuZyIsInN1cHBvcnRlZF9sYW5ndWFnZXMiLCJodW1hbml6ZUR1cmF0aW9uIiwiZ2V0U3VwcG9ydGVkTGFuZ3VhZ2VzIiwiaW5kZXhPZiIsImh1bWFuaXplciIsImhhbGZVbml0IiwiZGlmZkZyb21BbGFybSIsInJvdW5kIiwidGltZSIsInVuaXRzIiwiY29uc29sZSIsImVycm9yIiwiUHJvZ3Jlc3NCYXJTZXJ2aWNlIiwic3RhcnRWYWx1ZSIsInJlbWFpbmluZ1RpbWUiLCJjb3V0ZG93biIsImVuZFRpbWVWYWx1ZSIsImluaXRpYWxDb3VudGRvd24iXSwibWFwcGluZ3MiOiJBQU9BLEdBQUlBLGFBQWNDLFFBQVFDLE9BQU8sWUFDOUJDLFVBQVUsU0FBVSxXQUFZLFNBQVVDLFVBQ3pDLE9BQ0VDLFNBQVUsS0FDVkMsU0FBUyxFQUNUQyxPQUNFQyxTQUFVLFlBQ1ZDLGNBQWUsYUFDZkMs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SCxNQUdKL0YsYUFHWCxJQUFJbUYsS0FBTXBILFFBQVFDLE9BQU8sUUFFekJtSCxLQUFJQyxRQUFRLHFCQUFzQixXQUVoQyxHQUFJZSxvQkFBcUIsWUF3Q3pCLE9BM0JBQSxvQkFBbUJyRSxVQUFVNEMscUJBQXVCLFNBQThCMEIsV0FBWUMsY0FBZTdILFlBQWE4SCxVQUN4SCxHQUNFQyxjQUNBQyxpQkFGRWxFLG1CQUFxQixDQXVCekIsT0FuQkErRCxnQkFBZ0MsSUFHYixPQUFoQjdILGFBQ0QrSCxhQUFlNUYsT0FBT25DLGFBQ3RCZ0ksaUJBQW1CRCxhQUFhM0YsS0FBS3dGLFdBQVksV0FDakQ5RCxtQkFBcUMsSUFBaEIrRCxjQUFzQkcsa0JBRzNDbEUsbUJBQXFDLElBQWhCK0QsY0FBc0JDLFNBRzdDaEUsbUJBQXFCLElBQU1BLG1CQUMzQkEsbUJBQXFCdkIsS0FBSytFLE1BQTJCLEdBQXJCeEQsb0JBQTJCLEdBRXhEQSxtQkFBcUIsTUFDdEJBLG1CQUFxQixLQUdoQkEsb0JBR0YsR0FBSTZEIiwiZmlsZSI6ImFuZ3VsYXItdGltZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIGFuZ3VsYXItdGltZXIgLSB2MS4zLjUgLSAyMDE3LTAzLTA5IDI6MTggUE1cbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9zaWRkaWkvYW5ndWxhci10aW1lclxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxNyBBZHJpYW4gV2FyZGVsbFxuICogTGljZW5zZWQgTUlUIDxodHRwczovL2dpdGh1Yi5jb20vc2lkZGlpL2FuZ3VsYXItdGltZXIvYmxvYi9tYXN0ZXIvTElDRU5TRS50eHQ+XG4gKi9cbnZhciB0aW1lck1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCd0aW1lcicsIFtdKVxuICAuZGlyZWN0aXZlKCd0aW1lcicsIFsnJGNvbXBpbGUnLCBmdW5jdGlvbiAoJGNvbXBpbGUpIHtcbiAgICByZXR1cm4gIHtcbiAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgcmVwbGFjZTogZmFsc2UsXG4gICAgICBzY29wZToge1xuICAgICAgICBpbnRlcnZhbDogJz1pbnRlcnZhbCcsXG4gICAgICAgIHN0YXJ0VGltZUF0dHI6ICc9c3RhcnRUaW1lJyxcbiAgICAgICAgZW5kVGltZUF0dHI6ICc9ZW5kVGltZScsXG4gICAgICAgIGNvdW50ZG93bmF0dHI6ICc9Y291bnRkb3duJyxcbiAgICAgICAgZmluaXNoQ2FsbGJhY2s6ICcmZmluaXNoQ2FsbGJhY2snLFxuICAgICAgICBhdXRvU3RhcnQ6ICcmYXV0b1N0YXJ0JyxcbiAgICAgICAgbGFuZ3VhZ2U6ICdAPycsXG4gICAgICAgIGZhbGxiYWNrOiAnQD8nLFxuICAgICAgICBtYXhUaW1lVW5pdDogJz0nLFxuICAgICAgICBzZWNvbmRzOiAnPT8nLFxuICAgICAgICBtaW51dGVzOiAnPT8nLFxuICAgICAgICBob3VyczogJz0/JyxcbiAgICAgICAgZGF5czogJz0/JyxcbiAgICAgICAgbW9udGhzOiAnPT8nLFxuICAgICAgICB5ZWFyczogJz0/JyxcbiAgICAgICAgc2Vjb25kc1M6ICc9PycsXG4gICAgICAgIG1pbnV0ZXNTOiAnPT8nLFxuICAgICAgICBob3Vyc1M6ICc9PycsXG4gICAgICAgIGRheXNTOiAnPT8nLFxuICAgICAgICBtb250aHNTOiAnPT8nLFxuICAgICAgICB5ZWFyc1M6ICc9PydcbiAgICAgIH0sXG4gICAgICBjb250cm9sbGVyOiBbJyRzY29wZScsICckZWxlbWVudCcsICckYXR0cnMnLCAnJHRpbWVvdXQnLCAnSTE4blNlcnZpY2UnLCAnJGludGVycG9sYXRlJywgJ3Byb2dyZXNzQmFyU2VydmljZScsIGZ1bmN0aW9uICgkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICR0aW1lb3V0LCBJMThuU2VydmljZSwgJGludGVycG9sYXRlLCBwcm9ncmVzc0JhclNlcnZpY2UpIHtcblxuICAgICAgICAvLyBDaGVja2luZyBmb3IgdHJpbSBmdW5jdGlvbiBzaW5jZSBJRTggZG9lc24ndCBoYXZlIGl0XG4gICAgICAgIC8vIElmIG5vdCBhIGZ1bmN0aW9uLCBjcmVhdGUgdGlybSB3aXRoIFJlZ0V4IHRvIG1pbWljIG5hdGl2ZSB0cmltXG4gICAgICAgIGlmICh0eXBlb2YgU3RyaW5nLnByb3RvdHlwZS50cmltICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgU3RyaW5nLnByb3RvdHlwZS50cmltID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgJycpO1xuICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvL2FuZ3VsYXIgMS4yIGRvZXNuJ3Qgc3VwcG9ydCBhdHRyaWJ1dGVzIGVuZGluZyBpbiBcIi1zdGFydFwiLCBzbyB3ZSdyZVxuICAgICAgICAvL3N1cHBvcnRpbmcgYm90aCBcImF1dG9zdGFydFwiIGFuZCBcImF1dG8tc3RhcnRcIiBhcyBhIHNvbHV0aW9uIGZvclxuICAgICAgICAvL2JhY2t3YXJkIGFuZCBmb3J3YXJkIGNvbXBhdGliaWxpdHkuXG4gICAgICAgICRzY29wZS5hdXRvU3RhcnQgPSAkYXR0cnMuYXV0b1N0YXJ0IHx8ICRhdHRycy5hdXRvc3RhcnQ7XG5cblxuICAgICAgICAkc2NvcGUubGFuZ3VhZ2UgPSAkc2NvcGUubGFuZ3VhZ2UgfHwgJ2VuJztcbiAgICAgICAgJHNjb3BlLmZhbGxiYWNrID0gJHNjb3BlLmZhbGxiYWNrIHx8ICdlbic7XG5cbiAgICAgICAgLy9hbGxvdyB0byBjaGFuZ2UgdGhlIGxhbmd1YWdlIG9mIHRoZSBkaXJlY3RpdmUgd2hpbGUgYWxyZWFkeSBsYXVuY2hlZFxuICAgICAgICAkc2NvcGUuJHdhdGNoKCdsYW5ndWFnZScsIGZ1bmN0aW9uKG5ld1ZhbCwgb2xkVmFsKSB7XG4gICAgICAgICAgaWYobmV3VmFsICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGkxOG5TZXJ2aWNlLmluaXQobmV3VmFsLCAkc2NvcGUuZmFsbGJhY2spO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9pbml0IG1vbWVudEpTIGkxOG4sIGRlZmF1bHQgZW5nbGlzaFxuICAgICAgICB2YXIgaTE4blNlcnZpY2UgPSBuZXcgSTE4blNlcnZpY2UoKTtcbiAgICAgICAgaTE4blNlcnZpY2UuaW5pdCgkc2NvcGUubGFuZ3VhZ2UsICRzY29wZS5mYWxsYmFjayk7XG5cbiAgICAgICAgLy9wcm9ncmVzcyBiYXJcbiAgICAgICAgJHNjb3BlLmRpc3BsYXlQcm9ncmVzc0JhciA9IDA7XG4gICAgICAgICRzY29wZS5kaXNwbGF5UHJvZ3Jlc3NBY3RpdmUgPSAnYWN0aXZlJzsgLy9Cb290c3RyYXAgYWN0aXZlIGVmZmVjdCBmb3IgcHJvZ3Jlc3MgYmFyXG5cbiAgICAgICAgaWYgKCRlbGVtZW50Lmh0bWwoKS50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgJGVsZW1lbnQuYXBwZW5kKCRjb21waWxlKCc8c3Bhbj4nICsgJGludGVycG9sYXRlLnN0YXJ0U3ltYm9sKCkgKyAnbWlsbGlzJyArICRpbnRlcnBvbGF0ZS5lbmRTeW1ib2woKSArICc8L3NwYW4+JykoJHNjb3BlKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJGVsZW1lbnQuYXBwZW5kKCRjb21waWxlKCRlbGVtZW50LmNvbnRlbnRzKCkpKCRzY29wZSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLnN0YXJ0VGltZSA9IG51bGw7XG4gICAgICAgICRzY29wZS5lbmRUaW1lID0gbnVsbDtcbiAgICAgICAgJHNjb3BlLnRpbWVvdXRJZCA9IG51bGw7XG4gICAgICAgICRzY29wZS5jb3VudGRvd24gPSBhbmd1bGFyLmlzTnVtYmVyKCRzY29wZS5jb3VudGRvd25hdHRyKSAmJiBwYXJzZUludCgkc2NvcGUuY291bnRkb3duYXR0ciwgMTApID49IDAgPyBwYXJzZUludCgkc2NvcGUuY291bnRkb3duYXR0ciwgMTApIDogdW5kZWZpbmVkO1xuICAgICAgICAkc2NvcGUuaXNSdW5uaW5nID0gZmFsc2U7XG5cbiAgICAgICAgJHNjb3BlLiRvbigndGltZXItc3RhcnQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJHNjb3BlLnN0YXJ0KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS4kb24oJ3RpbWVyLXJlc3VtZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAkc2NvcGUucmVzdW1lKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS4kb24oJ3RpbWVyLXN0b3AnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJHNjb3BlLnN0b3AoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiRvbigndGltZXItY2xlYXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgJHNjb3BlLmNsZWFyKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS4kb24oJ3RpbWVyLXJlc2V0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICRzY29wZS5yZXNldCgpO1xuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuJG9uKCd0aW1lci1zZXQtY291bnRkb3duJywgZnVuY3Rpb24gKGUsIGNvdW50ZG93bikge1xuICAgICAgICAgICRzY29wZS5jb3VudGRvd24gPSBjb3VudGRvd247XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIHJlc2V0VGltZW91dCgpIHtcbiAgICAgICAgICBpZiAoJHNjb3BlLnRpbWVvdXRJZCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KCRzY29wZS50aW1lb3V0SWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ3N0YXJ0VGltZUF0dHInLCBmdW5jdGlvbihuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgICBpZiAobmV3VmFsdWUgIT09IG9sZFZhbHVlICYmICRzY29wZS5pc1J1bm5pbmcpIHtcbiAgICAgICAgICAgICRzY29wZS5zdGFydCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCgnZW5kVGltZUF0dHInLCBmdW5jdGlvbihuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgICBpZiAobmV3VmFsdWUgIT09IG9sZFZhbHVlICYmICRzY29wZS5pc1J1bm5pbmcpIHtcbiAgICAgICAgICAgICRzY29wZS5zdGFydCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICRzY29wZS5zdGFydFRpbWUgPSAkc2NvcGUuc3RhcnRUaW1lQXR0ciA/IG1vbWVudCgkc2NvcGUuc3RhcnRUaW1lQXR0cikgOiBtb21lbnQoKTtcbiAgICAgICAgICAkc2NvcGUuZW5kVGltZSA9ICRzY29wZS5lbmRUaW1lQXR0ciA/IG1vbWVudCgkc2NvcGUuZW5kVGltZUF0dHIpIDogbnVsbDtcbiAgICAgICAgICBpZiAoIWFuZ3VsYXIuaXNOdW1iZXIoJHNjb3BlLmNvdW50ZG93bikpIHtcbiAgICAgICAgICAgICRzY29wZS5jb3VudGRvd24gPSBhbmd1bGFyLmlzTnVtYmVyKCRzY29wZS5jb3VudGRvd25hdHRyKSAmJiBwYXJzZUludCgkc2NvcGUuY291bnRkb3duYXR0ciwgMTApID4gMCA/IHBhcnNlSW50KCRzY29wZS5jb3VudGRvd25hdHRyLCAxMCkgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJlc2V0VGltZW91dCgpO1xuICAgICAgICAgIHRpY2soKTtcbiAgICAgICAgICAkc2NvcGUuaXNSdW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgICAkc2NvcGUuJGVtaXQoJ3RpbWVyLXN0YXJ0ZWQnLCB7XG4gICAgICAgICAgICB0aW1lb3V0SWQ6ICRzY29wZS50aW1lb3V0SWQsXG4gICAgICAgICAgICBtaWxsaXM6ICRzY29wZS5taWxsaXMsXG4gICAgICAgICAgICBzZWNvbmRzOiAkc2NvcGUuc2Vjb25kcyxcbiAgICAgICAgICAgIG1pbnV0ZXM6ICRzY29wZS5taW51dGVzLFxuICAgICAgICAgICAgaG91cnM6ICRzY29wZS5ob3VycyxcbiAgICAgICAgICAgIGRheXM6ICRzY29wZS5kYXlzXG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnJlc3VtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXNldFRpbWVvdXQoKTtcbiAgICAgICAgICBpZiAoJHNjb3BlLmNvdW50ZG93bmF0dHIpIHtcbiAgICAgICAgICAgICRzY29wZS5jb3VudGRvd24gKz0gMTtcbiAgICAgICAgICB9XG4gICAgICAgICAgJHNjb3BlLnN0YXJ0VGltZSA9IG1vbWVudCgpLmRpZmYoKG1vbWVudCgkc2NvcGUuc3RvcHBlZFRpbWUpLmRpZmYobW9tZW50KCRzY29wZS5zdGFydFRpbWUpKSkpO1xuICAgICAgICAgIHRpY2soKTtcbiAgICAgICAgICAkc2NvcGUuaXNSdW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgICAkc2NvcGUuJGVtaXQoJ3RpbWVyLXN0YXJ0ZWQnLCB7XG4gICAgICAgICAgICB0aW1lb3V0SWQ6ICRzY29wZS50aW1lb3V0SWQsXG4gICAgICAgICAgICBtaWxsaXM6ICRzY29wZS5taWxsaXMsXG4gICAgICAgICAgICBzZWNvbmRzOiAkc2NvcGUuc2Vjb25kcyxcbiAgICAgICAgICAgIG1pbnV0ZXM6ICRzY29wZS5taW51dGVzLFxuICAgICAgICAgICAgaG91cnM6ICRzY29wZS5ob3VycyxcbiAgICAgICAgICAgIGRheXM6ICRzY29wZS5kYXlzXG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnN0b3AgPSAkc2NvcGUucGF1c2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIHRpbWVvdXRJZCA9ICRzY29wZS50aW1lb3V0SWQ7XG4gICAgICAgICAgJHNjb3BlLmNsZWFyKCk7XG4gICAgICAgICAgJHNjb3BlLiRlbWl0KCd0aW1lci1zdG9wcGVkJywge1xuICAgICAgICAgICAgdGltZW91dElkOiB0aW1lb3V0SWQsXG4gICAgICAgICAgICBtaWxsaXM6ICRzY29wZS5taWxsaXMsXG4gICAgICAgICAgICBzZWNvbmRzOiAkc2NvcGUuc2Vjb25kcyxcbiAgICAgICAgICAgIG1pbnV0ZXM6ICRzY29wZS5taW51dGVzLFxuICAgICAgICAgICAgaG91cnM6ICRzY29wZS5ob3VycyxcbiAgICAgICAgICAgIGRheXM6ICRzY29wZS5kYXlzXG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIC8vIHNhbWUgYXMgc3RvcCBidXQgd2l0aG91dCB0aGUgZXZlbnQgYmVpbmcgdHJpZ2dlcmVkXG4gICAgICAgICAgJHNjb3BlLnN0b3BwZWRUaW1lID0gbW9tZW50KCk7XG4gICAgICAgICAgcmVzZXRUaW1lb3V0KCk7XG4gICAgICAgICAgJHNjb3BlLnRpbWVvdXRJZCA9IG51bGw7XG4gICAgICAgICAgJHNjb3BlLmlzUnVubmluZyA9IGZhbHNlO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAkc2NvcGUuc3RhcnRUaW1lID0gJHNjb3BlLnN0YXJ0VGltZUF0dHIgPyBtb21lbnQoJHNjb3BlLnN0YXJ0VGltZUF0dHIpIDogbW9tZW50KCk7XG4gICAgICAgICAgJHNjb3BlLmVuZFRpbWUgPSAkc2NvcGUuZW5kVGltZUF0dHIgPyBtb21lbnQoJHNjb3BlLmVuZFRpbWVBdHRyKSA6IG51bGw7XG4gICAgICAgICAgJHNjb3BlLmNvdW50ZG93biA9IGFuZ3VsYXIuaXNOdW1iZXIoJHNjb3BlLmNvdW50ZG93bmF0dHIpICYmIHBhcnNlSW50KCRzY29wZS5jb3VudGRvd25hdHRyLCAxMCkgPiAwID8gcGFyc2VJbnQoJHNjb3BlLmNvdW50ZG93bmF0dHIsIDEwKSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICByZXNldFRpbWVvdXQoKTtcbiAgICAgICAgICB0aWNrKCk7XG4gICAgICAgICAgJHNjb3BlLmlzUnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICRzY29wZS5jbGVhcigpO1xuICAgICAgICAgICRzY29wZS4kZW1pdCgndGltZXItcmVzZXQnLCB7XG4gICAgICAgICAgICB0aW1lb3V0SWQ6IHRpbWVvdXRJZCxcbiAgICAgICAgICAgIG1pbGxpczogJHNjb3BlLm1pbGxpcyxcbiAgICAgICAgICAgIHNlY29uZHM6ICRzY29wZS5zZWNvbmRzLFxuICAgICAgICAgICAgbWludXRlczogJHNjb3BlLm1pbnV0ZXMsXG4gICAgICAgICAgICBob3VyczogJHNjb3BlLmhvdXJzLFxuICAgICAgICAgICAgZGF5czogJHNjb3BlLmRheXNcbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkZWxlbWVudC5iaW5kKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXNldFRpbWVvdXQoKTtcbiAgICAgICAgICAkc2NvcGUuaXNSdW5uaW5nID0gZmFsc2U7XG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgZnVuY3Rpb24gY2FsY3VsYXRlVGltZVVuaXRzKCkge1xuICAgICAgICAgIHZhciB0aW1lVW5pdHMgPSB7fTsgLy93aWxsIGNvbnRhaW5zIHRpbWUgd2l0aCB1bml0c1xuXG4gICAgICAgICAgaWYgKCRhdHRycy5zdGFydFRpbWUgIT09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAkc2NvcGUubWlsbGlzID0gbW9tZW50KCkuZGlmZihtb21lbnQoJHNjb3BlLnN0YXJ0VGltZUF0dHIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aW1lVW5pdHMgPSBpMThuU2VydmljZS5nZXRUaW1lVW5pdHMoJHNjb3BlLm1pbGxpcyk7XG5cbiAgICAgICAgICAvLyBjb21wdXRlIHRpbWUgdmFsdWVzIGJhc2VkIG9uIG1heFRpbWVVbml0IHNwZWNpZmljYXRpb25cbiAgICAgICAgICBpZiAoISRzY29wZS5tYXhUaW1lVW5pdCB8fCAkc2NvcGUubWF4VGltZVVuaXQgPT09ICdkYXknKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2Vjb25kcyA9IE1hdGguZmxvb3IoKCRzY29wZS5taWxsaXMgLyAxMDAwKSAlIDYwKTtcbiAgICAgICAgICAgICRzY29wZS5taW51dGVzID0gTWF0aC5mbG9vcigoKCRzY29wZS5taWxsaXMgLyAoNjAwMDApKSAlIDYwKSk7XG4gICAgICAgICAgICAkc2NvcGUuaG91cnMgPSBNYXRoLmZsb29yKCgoJHNjb3BlLm1pbGxpcyAvICgzNjAwMDAwKSkgJSAyNCkpO1xuICAgICAgICAgICAgJHNjb3BlLmRheXMgPSBNYXRoLmZsb29yKCgoJHNjb3BlLm1pbGxpcyAvICgzNjAwMDAwKSkgLyAyNCkpO1xuICAgICAgICAgICAgJHNjb3BlLm1vbnRocyA9IDA7XG4gICAgICAgICAgICAkc2NvcGUueWVhcnMgPSAwO1xuICAgICAgICAgIH0gZWxzZSBpZiAoJHNjb3BlLm1heFRpbWVVbml0ID09PSAnc2Vjb25kJykge1xuICAgICAgICAgICAgJHNjb3BlLnNlY29uZHMgPSBNYXRoLmZsb29yKCRzY29wZS5taWxsaXMgLyAxMDAwKTtcbiAgICAgICAgICAgICRzY29wZS5taW51dGVzID0gMDtcbiAgICAgICAgICAgICRzY29wZS5ob3VycyA9IDA7XG4gICAgICAgICAgICAkc2NvcGUuZGF5cyA9IDA7XG4gICAgICAgICAgICAkc2NvcGUubW9udGhzID0gMDtcbiAgICAgICAgICAgICRzY29wZS55ZWFycyA9IDA7XG4gICAgICAgICAgfSBlbHNlIGlmICgkc2NvcGUubWF4VGltZVVuaXQgPT09ICdtaW51dGUnKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2Vjb25kcyA9IE1hdGguZmxvb3IoKCRzY29wZS5taWxsaXMgLyAxMDAwKSAlIDYwKTtcbiAgICAgICAgICAgICRzY29wZS5taW51dGVzID0gTWF0aC5mbG9vcigkc2NvcGUubWlsbGlzIC8gNjAwMDApO1xuICAgICAgICAgICAgJHNjb3BlLmhvdXJzID0gMDtcbiAgICAgICAgICAgICRzY29wZS5kYXlzID0gMDtcbiAgICAgICAgICAgICRzY29wZS5tb250aHMgPSAwO1xuICAgICAgICAgICAgJHNjb3BlLnllYXJzID0gMDtcbiAgICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5tYXhUaW1lVW5pdCA9PT0gJ2hvdXInKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2Vjb25kcyA9IE1hdGguZmxvb3IoKCRzY29wZS5taWxsaXMgLyAxMDAwKSAlIDYwKTtcbiAgICAgICAgICAgICRzY29wZS5taW51dGVzID0gTWF0aC5mbG9vcigoKCRzY29wZS5taWxsaXMgLyAoNjAwMDApKSAlIDYwKSk7XG4gICAgICAgICAgICAkc2NvcGUuaG91cnMgPSBNYXRoLmZsb29yKCRzY29wZS5taWxsaXMgLyAzNjAwMDAwKTtcbiAgICAgICAgICAgICRzY29wZS5kYXlzID0gMDtcbiAgICAgICAgICAgICRzY29wZS5tb250aHMgPSAwO1xuICAgICAgICAgICAgJHNjb3BlLnllYXJzID0gMDtcbiAgICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5tYXhUaW1lVW5pdCA9PT0gJ21vbnRoJykge1xuICAgICAgICAgICAgJHNjb3BlLnNlY29uZHMgPSBNYXRoLmZsb29yKCgkc2NvcGUubWlsbGlzIC8gMTAwMCkgJSA2MCk7XG4gICAgICAgICAgICAkc2NvcGUubWludXRlcyA9IE1hdGguZmxvb3IoKCgkc2NvcGUubWlsbGlzIC8gKDYwMDAwKSkgJSA2MCkpO1xuICAgICAgICAgICAgJHNjb3BlLmhvdXJzID0gTWF0aC5mbG9vcigoKCRzY29wZS5taWxsaXMgLyAoMzYwMDAwMCkpICUgMjQpKTtcbiAgICAgICAgICAgICRzY29wZS5kYXlzID0gTWF0aC5mbG9vcigoKCRzY29wZS5taWxsaXMgLyAoMzYwMDAwMCkpIC8gMjQpICUgMzApO1xuICAgICAgICAgICAgJHNjb3BlLm1vbnRocyA9IE1hdGguZmxvb3IoKCgkc2NvcGUubWlsbGlzIC8gKDM2MDAwMDApKSAvIDI0KSAvIDMwKTtcbiAgICAgICAgICAgICRzY29wZS55ZWFycyA9IDA7XG4gICAgICAgICAgfSBlbHNlIGlmICgkc2NvcGUubWF4VGltZVVuaXQgPT09ICd5ZWFyJykge1xuICAgICAgICAgICAgJHNjb3BlLnNlY29uZHMgPSBNYXRoLmZsb29yKCgkc2NvcGUubWlsbGlzIC8gMTAwMCkgJSA2MCk7XG4gICAgICAgICAgICAkc2NvcGUubWludXRlcyA9IE1hdGguZmxvb3IoKCgkc2NvcGUubWlsbGlzIC8gKDYwMDAwKSkgJSA2MCkpO1xuICAgICAgICAgICAgJHNjb3BlLmhvdXJzID0gTWF0aC5mbG9vcigoKCRzY29wZS5taWxsaXMgLyAoMzYwMDAwMCkpICUgMjQpKTtcbiAgICAgICAgICAgICRzY29wZS5kYXlzID0gTWF0aC5mbG9vcigoKCRzY29wZS5taWxsaXMgLyAoMzYwMDAwMCkpIC8gMjQpICUgMzApO1xuICAgICAgICAgICAgJHNjb3BlLm1vbnRocyA9IE1hdGguZmxvb3IoKCgkc2NvcGUubWlsbGlzIC8gKDM2MDAwMDApKSAvIDI0IC8gMzApICUgMTIpO1xuICAgICAgICAgICAgJHNjb3BlLnllYXJzID0gTWF0aC5mbG9vcigoJHNjb3BlLm1pbGxpcyAvICgzNjAwMDAwKSkgLyAyNCAvIDM2NSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIHBsdXJhbCAtIHNpbmd1bGFyIHVuaXQgZGVjaXNpb24gKG9sZCBzeW50YXgsIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSBhbmQgRW5nbGlzaCBvbmx5LCBjb3VsZCBiZSBkZXByZWNhdGVkISlcbiAgICAgICAgICAkc2NvcGUuc2Vjb25kc1MgPSAoJHNjb3BlLnNlY29uZHMgPT09IDEpID8gJycgOiAncyc7XG4gICAgICAgICAgJHNjb3BlLm1pbnV0ZXNTID0gKCRzY29wZS5taW51dGVzID09PSAxKSA/ICcnIDogJ3MnO1xuICAgICAgICAgICRzY29wZS5ob3Vyc1MgPSAoJHNjb3BlLmhvdXJzID09PSAxKSA/ICcnIDogJ3MnO1xuICAgICAgICAgICRzY29wZS5kYXlzUyA9ICgkc2NvcGUuZGF5cyA9PT0gMSk/ICcnIDogJ3MnO1xuICAgICAgICAgICRzY29wZS5tb250aHNTID0gKCRzY29wZS5tb250aHMgPT09IDEpPyAnJyA6ICdzJztcbiAgICAgICAgICAkc2NvcGUueWVhcnNTID0gKCRzY29wZS55ZWFycyA9PT0gMSk/ICcnIDogJ3MnO1xuXG5cbiAgICAgICAgICAvLyBuZXcgcGx1cmFsLXNpbmd1bGFyIHVuaXQgZGVjaXNpb24gZnVuY3Rpb25zIChmb3IgY3VzdG9tIHVuaXRzIGFuZCBtdWx0aWxpbmd1YWwgc3VwcG9ydClcbiAgICAgICAgICAkc2NvcGUuc2Vjb25kVW5pdCA9IHRpbWVVbml0cy5zZWNvbmRzO1xuICAgICAgICAgICRzY29wZS5taW51dGVVbml0ID0gdGltZVVuaXRzLm1pbnV0ZXM7XG4gICAgICAgICAgJHNjb3BlLmhvdXJVbml0ID0gdGltZVVuaXRzLmhvdXJzO1xuICAgICAgICAgICRzY29wZS5kYXlVbml0ID0gdGltZVVuaXRzLmRheXM7XG4gICAgICAgICAgJHNjb3BlLm1vbnRoVW5pdCA9IHRpbWVVbml0cy5tb250aHM7XG4gICAgICAgICAgJHNjb3BlLnllYXJVbml0ID0gdGltZVVuaXRzLnllYXJzO1xuXG4gICAgICAgICAgLy9hZGQgbGVhZGluZyB6ZXJvIGlmIG51bWJlciBpcyBzbWFsbGVyIHRoYW4gMTBcbiAgICAgICAgICAkc2NvcGUuc3NlY29uZHMgPSAkc2NvcGUuc2Vjb25kcyA8IDEwID8gJzAnICsgJHNjb3BlLnNlY29uZHMgOiAkc2NvcGUuc2Vjb25kcztcbiAgICAgICAgICAkc2NvcGUubW1pbnV0ZXMgPSAkc2NvcGUubWludXRlcyA8IDEwID8gJzAnICsgJHNjb3BlLm1pbnV0ZXMgOiAkc2NvcGUubWludXRlcztcbiAgICAgICAgICAkc2NvcGUuaGhvdXJzID0gJHNjb3BlLmhvdXJzIDwgMTAgPyAnMCcgKyAkc2NvcGUuaG91cnMgOiAkc2NvcGUuaG91cnM7XG4gICAgICAgICAgJHNjb3BlLmRkYXlzID0gJHNjb3BlLmRheXMgPCAxMCA/ICcwJyArICRzY29wZS5kYXlzIDogJHNjb3BlLmRheXM7XG4gICAgICAgICAgJHNjb3BlLm1tb250aHMgPSAkc2NvcGUubW9udGhzIDwgMTAgPyAnMCcgKyAkc2NvcGUubW9udGhzIDogJHNjb3BlLm1vbnRocztcbiAgICAgICAgICAkc2NvcGUueXllYXJzID0gJHNjb3BlLnllYXJzIDwgMTAgPyAnMCcgKyAkc2NvcGUueWVhcnMgOiAkc2NvcGUueWVhcnM7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIC8vZGV0ZXJtaW5lIGluaXRpYWwgdmFsdWVzIG9mIHRpbWUgdW5pdHMgYW5kIGFkZCBBZGRTZWNvbmRzIGZ1bmN0aW9uYWxpdHlcbiAgICAgICAgaWYgKCRzY29wZS5jb3VudGRvd25hdHRyKSB7XG4gICAgICAgICAgJHNjb3BlLm1pbGxpcyA9ICRzY29wZS5jb3VudGRvd25hdHRyICogMTAwMDtcblxuICAgICAgICAgICRzY29wZS5hZGRDRFNlY29uZHMgPSBmdW5jdGlvbiAoZXh0cmFTZWNvbmRzKSB7XG4gICAgICAgICAgICAkc2NvcGUuY291bnRkb3duICs9IGV4dHJhU2Vjb25kcztcbiAgICAgICAgICAgIGlmICghJHNjb3BlLmlzUnVubmluZykge1xuICAgICAgICAgICAgICAkc2NvcGUuc3RhcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgJHNjb3BlLiRvbigndGltZXItYWRkLWNkLXNlY29uZHMnLCBmdW5jdGlvbiAoZSwgZXh0cmFTZWNvbmRzKSB7XG4gICAgICAgICAgICAgJHNjb3BlLmFkZENEU2Vjb25kcyhleHRyYVNlY29uZHMpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgJHNjb3BlLiRvbigndGltZXItc2V0LWNvdW50ZG93bi1zZWNvbmRzJywgZnVuY3Rpb24gKGUsIGNvdW50ZG93blNlY29uZHMpIHtcbiAgICAgICAgICAgIGlmICghJHNjb3BlLmlzUnVubmluZykge1xuICAgICAgICAgICAgICAkc2NvcGUuY2xlYXIoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLmNvdW50ZG93biA9IGNvdW50ZG93blNlY29uZHM7XG4gICAgICAgICAgICAkc2NvcGUubWlsbGlzID0gY291bnRkb3duU2Vjb25kcyAqIDEwMDA7XG4gICAgICAgICAgICBjYWxjdWxhdGVUaW1lVW5pdHMoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkc2NvcGUubWlsbGlzID0gMDtcbiAgICAgICAgfVxuICAgICAgICBjYWxjdWxhdGVUaW1lVW5pdHMoKTtcblxuICAgICAgICB2YXIgdGljayA9IGZ1bmN0aW9uIHRpY2soKSB7XG4gICAgICAgICAgdmFyIHR5cGVUaW1lciA9IG51bGw7IC8vIGNvdW50ZG93biBvciBlbmRUaW1lQXR0clxuICAgICAgICAgICRzY29wZS5taWxsaXMgPSBtb21lbnQoKS5kaWZmKCRzY29wZS5zdGFydFRpbWUpO1xuICAgICAgICAgIHZhciBhZGp1c3RtZW50ID0gJHNjb3BlLm1pbGxpcyAlIDEwMDA7XG5cbiAgICAgICAgICBpZiAoJHNjb3BlLmVuZFRpbWVBdHRyKSB7XG4gICAgICAgICAgICB0eXBlVGltZXIgPSAkc2NvcGUuZW5kVGltZUF0dHI7XG4gICAgICAgICAgICAkc2NvcGUubWlsbGlzID0gbW9tZW50KCRzY29wZS5lbmRUaW1lKS5kaWZmKG1vbWVudCgpKTtcbiAgICAgICAgICAgIGFkanVzdG1lbnQgPSAkc2NvcGUuaW50ZXJ2YWwgLSAkc2NvcGUubWlsbGlzICUgMTAwMDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoJHNjb3BlLmNvdW50ZG93bmF0dHIpIHtcbiAgICAgICAgICAgIHR5cGVUaW1lciA9ICRzY29wZS5jb3VudGRvd25hdHRyO1xuICAgICAgICAgICAgJHNjb3BlLm1pbGxpcyA9ICRzY29wZS5jb3VudGRvd24gKiAxMDAwO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICgkc2NvcGUubWlsbGlzIDwgMCkge1xuICAgICAgICAgICAgJHNjb3BlLnN0b3AoKTtcbiAgICAgICAgICAgICRzY29wZS5taWxsaXMgPSAwO1xuICAgICAgICAgICAgY2FsY3VsYXRlVGltZVVuaXRzKCk7XG4gICAgICAgICAgICBpZigkc2NvcGUuZmluaXNoQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgJHNjb3BlLiRldmFsKCRzY29wZS5maW5pc2hDYWxsYmFjayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGNhbGN1bGF0ZVRpbWVVbml0cygpO1xuXG4gICAgICAgICAgLy9XZSBhcmUgbm90IHVzaW5nICR0aW1lb3V0IGZvciBhIHJlYXNvbi4gUGxlYXNlIHJlYWQgaGVyZSAtIGh0dHBzOi8vZ2l0aHViLmNvbS9zaWRkaWkvYW5ndWxhci10aW1lci9wdWxsLzVcbiAgICAgICAgICAkc2NvcGUudGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHRpY2soKTtcbiAgICAgICAgICAgICAgLy8gc2luY2UgeW91IGNob29zZSBub3QgdG8gdXNlICR0aW1lb3V0LCBhdCBsZWFzdCBwcmVzZXJ2ZSBhbmd1bGFyIGN5Y2xlIHR3byB3YXkgZGF0YSBiaW5kaW5nXG4gICAgICAgICAgICAgIC8vIGJ5IGNhbGxpbmcgJHNjb3BlLiRhcHBseSgpIGluc3RlYWQgb2YgJHNjb3BlLiRkaWdlc3QoKVxuICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgfSwgJHNjb3BlLmludGVydmFsIC0gYWRqdXN0bWVudCk7XG5cbiAgICAgICAgICAkc2NvcGUuJGVtaXQoJ3RpbWVyLXRpY2snLCB7XG4gICAgICAgICAgICB0aW1lb3V0SWQ6ICRzY29wZS50aW1lb3V0SWQsXG4gICAgICAgICAgICBtaWxsaXM6ICRzY29wZS5taWxsaXMsXG4gICAgICAgICAgICBzZWNvbmRzOiAkc2NvcGUuc2Vjb25kcyxcbiAgICAgICAgICAgIG1pbnV0ZXM6ICRzY29wZS5taW51dGVzLFxuICAgICAgICAgICAgaG91cnM6ICRzY29wZS5ob3VycyxcbiAgICAgICAgICAgIGRheXM6ICRzY29wZS5kYXlzXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpZiAoJHNjb3BlLmNvdW50ZG93biA+IDApIHtcbiAgICAgICAgICAgICRzY29wZS5jb3VudGRvd24tLTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAoJHNjb3BlLmNvdW50ZG93biA8PSAwKSB7XG4gICAgICAgICAgICAkc2NvcGUuc3RvcCgpO1xuICAgICAgICAgICAgaWYoJHNjb3BlLmZpbmlzaENhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICRzY29wZS4kZXZhbCgkc2NvcGUuZmluaXNoQ2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmKHR5cGVUaW1lciAhPT0gbnVsbCl7XG4gICAgICAgICAgICAvL2NhbGN1bGF0ZSBwcm9ncmVzcyBiYXJcbiAgICAgICAgICAgICRzY29wZS5wcm9ncmVzc0JhciA9IHByb2dyZXNzQmFyU2VydmljZS5jYWxjdWxhdGVQcm9ncmVzc0Jhcigkc2NvcGUuc3RhcnRUaW1lLCAkc2NvcGUubWlsbGlzLCAkc2NvcGUuZW5kVGltZSwgJHNjb3BlLmNvdW50ZG93bmF0dHIpO1xuXG4gICAgICAgICAgICBpZigkc2NvcGUucHJvZ3Jlc3NCYXIgPT09IDEwMCl7XG4gICAgICAgICAgICAgICRzY29wZS5kaXNwbGF5UHJvZ3Jlc3NBY3RpdmUgPSAnJzsgLy9ObyBtb3JlIEJvb3RzdHJhcCBhY3RpdmUgZWZmZWN0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmICgkc2NvcGUuYXV0b1N0YXJ0ID09PSB1bmRlZmluZWQgfHwgJHNjb3BlLmF1dG9TdGFydCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICRzY29wZS5zdGFydCgpO1xuICAgICAgICB9XG4gICAgICB9XVxuICAgIH07XG4gIH1dKVxuICAuZGlyZWN0aXZlKCd0aW1lckNvbnRyb2xzJywgZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgc2NvcGU6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSkge1xuICAgICAgICAkc2NvcGUudGltZXJTdGF0dXMgPSBcInJlc2V0XCI7XG4gICAgICAgICRzY29wZS4kb24oJ3RpbWVyLXN0YXJ0ZWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkc2NvcGUudGltZXJTdGF0dXMgPSBcInN0YXJ0ZWRcIjtcbiAgICAgICAgfSk7XG4gICAgICAgICRzY29wZS4kb24oJ3RpbWVyLXN0b3BwZWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkc2NvcGUudGltZXJTdGF0dXMgPSBcInN0b3BwZWRcIjtcbiAgICAgICAgfSk7XG4gICAgICAgICRzY29wZS4kb24oJ3RpbWVyLXJlc2V0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgJHNjb3BlLnRpbWVyU3RhdHVzID0gXCJyZXNldFwiO1xuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLnRpbWVyU3RhcnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgndGltZXItc3RhcnQnKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnRpbWVyU3RvcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCd0aW1lci1zdG9wJyk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS50aW1lclJlc3VtZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCd0aW1lci1yZXN1bWUnKTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnRpbWVyVG9nZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgc3dpdGNoICgkc2NvcGUudGltZXJTdGF0dXMpIHtcbiAgICAgICAgICAgIGNhc2UgXCJzdGFydGVkXCI6XG4gICAgICAgICAgICAgICRzY29wZS50aW1lclN0b3AoKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic3RvcHBlZFwiOlxuICAgICAgICAgICAgICAkc2NvcGUudGltZXJSZXN1bWUoKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicmVzZXRcIjpcbiAgICAgICAgICAgICAgJHNjb3BlLnRpbWVyU3RhcnQoKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUudGltZXJBZGRDRFNlY29uZHMgPSBmdW5jdGlvbihleHRyYVNlY29uZHMpIHtcbiAgICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgndGltZXItYWRkLWNkLXNlY29uZHMnLCBleHRyYVNlY29uZHMpO1xuICAgICAgICB9O1xuICAgICAgfV1cbiAgICB9O1xuICB9KTtcblxuLyogY29tbW9uanMgcGFja2FnZSBtYW5hZ2VyIHN1cHBvcnQgKGVnIGNvbXBvbmVudGpzKSAqL1xuaWYgKHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCIgJiYgdHlwZW9mIGV4cG9ydHMgIT09IFwidW5kZWZpbmVkXCIgJiYgbW9kdWxlLmV4cG9ydHMgPT09IGV4cG9ydHMpe1xuICBtb2R1bGUuZXhwb3J0cyA9IHRpbWVyTW9kdWxlO1xufVxuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ3RpbWVyJyk7XG5cbmFwcC5mYWN0b3J5KCdJMThuU2VydmljZScsIGZ1bmN0aW9uKCkge1xuXG4gICAgdmFyIEkxOG5TZXJ2aWNlID0gZnVuY3Rpb24oKSB7fTtcblxuICAgIEkxOG5TZXJ2aWNlLnByb3RvdHlwZS5sYW5ndWFnZSA9ICdlbic7XG4gICAgSTE4blNlcnZpY2UucHJvdG90eXBlLmZhbGxiYWNrID0gJ2VuJztcbiAgICBJMThuU2VydmljZS5wcm90b3R5cGUudGltZUh1bWFuaXplciA9IHt9O1xuXG4gICAgSTE4blNlcnZpY2UucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiBpbml0KGxhbmcsIGZhbGxiYWNrKSB7XG4gICAgICAgIHZhciBzdXBwb3J0ZWRfbGFuZ3VhZ2VzID0gaHVtYW5pemVEdXJhdGlvbi5nZXRTdXBwb3J0ZWRMYW5ndWFnZXMoKTtcblxuICAgICAgICB0aGlzLmZhbGxiYWNrID0gKGZhbGxiYWNrICE9PSB1bmRlZmluZWQpID8gZmFsbGJhY2sgOiAnZW4nO1xuICAgICAgICBpZiAoc3VwcG9ydGVkX2xhbmd1YWdlcy5pbmRleE9mKGZhbGxiYWNrKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuZmFsbGJhY2sgPSAnZW4nO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5sYW5ndWFnZSA9IGxhbmc7XG4gICAgICAgIGlmIChzdXBwb3J0ZWRfbGFuZ3VhZ2VzLmluZGV4T2YobGFuZykgPT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLmxhbmd1YWdlID0gdGhpcy5mYWxsYmFjaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEl0IHNob3VsZCBiZSBoYW5kbGUgYnkgdGhlIHVzZXIncyBhcHBsaWNhdGlvbiBpdHNlbGYsIGFuZCBub3QgaW5zaWRlIHRoZSBkaXJlY3RpdmVcbiAgICAgICAgLy8gbW9tZW50IGluaXRcbiAgICAgICAgLy8gbW9tZW50LmxvY2FsZSh0aGlzLmxhbmd1YWdlKTtcblxuICAgICAgICAvL2h1bWFuIGR1cmF0aW9uIGluaXQsIHVzaW5nIGl0IGJlY2F1c2UgbW9tZW50anMgZG9lcyBub3QgYWxsb3cgYWNjdXJhdGUgdGltZSAoXG4gICAgICAgIC8vIG1vbWVudEpTOiBhIGZldyBtb21lbnQgYWdvLCBodW1hbiBkdXJhdGlvbiA6IDQgc2Vjb25kcyBhZ29cbiAgICAgICAgdGhpcy50aW1lSHVtYW5pemVyID0gaHVtYW5pemVEdXJhdGlvbi5odW1hbml6ZXIoe1xuICAgICAgICAgICAgbGFuZ3VhZ2U6IHRoaXMubGFuZ3VhZ2UsXG4gICAgICAgICAgICBoYWxmVW5pdDpmYWxzZVxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogZ2V0IHRpbWUgd2l0aCB1bml0cyBmcm9tIG1vbWVudEpTIGkxOG5cbiAgICAgKiBAcGFyYW0ge2ludH0gbWlsbGlzXG4gICAgICogQHJldHVybnMge3ttaWxsaXM6IHN0cmluZywgc2Vjb25kczogc3RyaW5nLCBtaW51dGVzOiBzdHJpbmcsIGhvdXJzOiBzdHJpbmcsIGRheXM6IHN0cmluZywgbW9udGhzOiBzdHJpbmcsIHllYXJzOiBzdHJpbmd9fVxuICAgICAqL1xuICAgIEkxOG5TZXJ2aWNlLnByb3RvdHlwZS5nZXRUaW1lVW5pdHMgPSBmdW5jdGlvbiBnZXRUaW1lVW5pdHMobWlsbGlzKSB7XG4gICAgICAgIHZhciBkaWZmRnJvbUFsYXJtID0gTWF0aC5yb3VuZChtaWxsaXMvMTAwMCkgKiAxMDAwOyAvL3RpbWUgaW4gbWlsbGlzZWNvbmRzLCBnZXQgcmlkIG9mIHRoZSBsYXN0IDMgbXMgdmFsdWUgdG8gYXZvaWQgMi4xMiBzZWNvbmRzIGRpc3BsYXlcblxuICAgICAgICB2YXIgdGltZSA9IHt9O1xuXG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy50aW1lSHVtYW5pemVyICE9ICd1bmRlZmluZWQnKXtcbiAgICAgICAgICAgIHRpbWUgPSB7XG4gICAgICAgICAgICAgICAgJ21pbGxpcycgOiB0aGlzLnRpbWVIdW1hbml6ZXIoZGlmZkZyb21BbGFybSwgeyB1bml0czogW1wibXNcIl0gfSksXG4gICAgICAgICAgICAgICAgJ3NlY29uZHMnIDogdGhpcy50aW1lSHVtYW5pemVyKGRpZmZGcm9tQWxhcm0sIHsgdW5pdHM6IFtcInNcIl0gfSksXG4gICAgICAgICAgICAgICAgJ21pbnV0ZXMnIDogdGhpcy50aW1lSHVtYW5pemVyKGRpZmZGcm9tQWxhcm0sIHsgdW5pdHM6IFtcIm1cIiwgXCJzXCJdIH0pICxcbiAgICAgICAgICAgICAgICAnaG91cnMnIDogdGhpcy50aW1lSHVtYW5pemVyKGRpZmZGcm9tQWxhcm0sIHsgdW5pdHM6IFtcImhcIiwgXCJtXCIsIFwic1wiXSB9KSAsXG4gICAgICAgICAgICAgICAgJ2RheXMnIDogdGhpcy50aW1lSHVtYW5pemVyKGRpZmZGcm9tQWxhcm0sIHsgdW5pdHM6IFtcImRcIiwgXCJoXCIsIFwibVwiLCBcInNcIl0gfSkgLFxuICAgICAgICAgICAgICAgICdtb250aHMnIDogdGhpcy50aW1lSHVtYW5pemVyKGRpZmZGcm9tQWxhcm0sIHsgdW5pdHM6IFtcIm1vXCIsIFwiZFwiLCBcImhcIiwgXCJtXCIsIFwic1wiXSB9KSAsXG4gICAgICAgICAgICAgICAgJ3llYXJzJyA6IHRoaXMudGltZUh1bWFuaXplcihkaWZmRnJvbUFsYXJtLCB7IHVuaXRzOiBbXCJ5XCIsIFwibW9cIiwgXCJkXCIsIFwiaFwiLCBcIm1cIiwgXCJzXCJdIH0pXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignaTE4blNlcnZpY2UgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkLiBZb3UgbXVzdCBjYWxsIGkxOG5TZXJ2aWNlLmluaXQoXCJlblwiKSBmb3IgZXhhbXBsZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRpbWU7XG4gICAgfTtcblxuICAgIHJldHVybiBJMThuU2VydmljZTtcbn0pO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ3RpbWVyJyk7XG5cbmFwcC5mYWN0b3J5KCdwcm9ncmVzc0JhclNlcnZpY2UnLCBmdW5jdGlvbigpIHtcblxuICB2YXIgUHJvZ3Jlc3NCYXJTZXJ2aWNlID0gZnVuY3Rpb24oKSB7fTtcblxuICAvKipcbiAgICogY2FsY3VsYXRlIHRoZSByZW1haW5pbmcgdGltZSBpbiBhIHByb2dyZXNzIGJhciBpbiBwZXJjZW50YWdlXG4gICAqIEBwYXJhbSB7bW9tZW50anN9IHN0YXJ0VmFsdWUgaW4gc2Vjb25kc1xuICAgKiBAcGFyYW0ge2ludGVnZXJ9IGN1cnJlbnRDb3VudGRvd24sIHdoZXJlIGFyZSB3ZSBpbiB0aGUgY291bnRkb3duXG4gICAqIEBwYXJhbSB7aW50ZWdlcn0gcmVtYWluaW5nVGltZSwgcmVtYWluaW5nIG1pbGxpc2Vjb25kc1xuICAgKiBAcGFyYW0ge2ludGVnZXJ9IGVuZFRpbWUsIGVuZCB0aW1lLCBjYW4gYmUgdW5kZWZpbmVkXG4gICAqIEBwYXJhbSB7aW50ZWdlcn0gY291dGRvd24sIG9yaWdpbmFsIGNvdXRkb3duIHZhbHVlLCBjYW4gYmUgdW5kZWZpbmVkXG4gICAqXG4gICAqIGpva2UgOiBodHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PWdFTlZCNnRqcV9NXG4gICAqIEByZXR1cm4ge2Zsb2F0fSAwIC0tPiAxMDBcbiAgICovXG4gIFByb2dyZXNzQmFyU2VydmljZS5wcm90b3R5cGUuY2FsY3VsYXRlUHJvZ3Jlc3NCYXIgPSBmdW5jdGlvbiBjYWxjdWxhdGVQcm9ncmVzc0JhcihzdGFydFZhbHVlLCByZW1haW5pbmdUaW1lLCBlbmRUaW1lQXR0ciwgY291dGRvd24pIHtcbiAgICB2YXIgZGlzcGxheVByb2dyZXNzQmFyID0gMCxcbiAgICAgIGVuZFRpbWVWYWx1ZSxcbiAgICAgIGluaXRpYWxDb3VudGRvd247XG5cbiAgICByZW1haW5pbmdUaW1lID0gcmVtYWluaW5nVGltZSAvIDEwMDA7IC8vc2Vjb25kc1xuXG5cbiAgICBpZihlbmRUaW1lQXR0ciAhPT0gbnVsbCl7XG4gICAgICBlbmRUaW1lVmFsdWUgPSBtb21lbnQoZW5kVGltZUF0dHIpO1xuICAgICAgaW5pdGlhbENvdW50ZG93biA9IGVuZFRpbWVWYWx1ZS5kaWZmKHN0YXJ0VmFsdWUsICdzZWNvbmRzJyk7XG4gICAgICBkaXNwbGF5UHJvZ3Jlc3NCYXIgPSByZW1haW5pbmdUaW1lICogMTAwIC8gaW5pdGlhbENvdW50ZG93bjtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBkaXNwbGF5UHJvZ3Jlc3NCYXIgPSByZW1haW5pbmdUaW1lICogMTAwIC8gY291dGRvd247XG4gICAgfVxuXG4gICAgZGlzcGxheVByb2dyZXNzQmFyID0gMTAwIC0gZGlzcGxheVByb2dyZXNzQmFyOyAvL1RvIGhhdmUgMCB0byAxMDAgYW5kIG5vdCAxMDAgdG8gMFxuICAgIGRpc3BsYXlQcm9ncmVzc0JhciA9IE1hdGgucm91bmQoZGlzcGxheVByb2dyZXNzQmFyICogMTApIC8gMTA7IC8vbGVhcm4gbW9yZSB3aHkgOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzU4ODAwNC9pcy1mbG9hdGluZy1wb2ludC1tYXRoLWJyb2tlblxuXG4gICAgaWYoZGlzcGxheVByb2dyZXNzQmFyID4gMTAwKXsgLy9zZWN1cml0eVxuICAgICAgZGlzcGxheVByb2dyZXNzQmFyID0gMTAwO1xuICAgIH1cblxuICAgIHJldHVybiBkaXNwbGF5UHJvZ3Jlc3NCYXI7XG4gIH07XG5cbiAgcmV0dXJuIG5ldyBQcm9ncmVzc0JhclNlcnZpY2UoKTtcbn0pO1xuIl19
